read_csv("data/processed/wells_wildfire_state_year.csv") %>%
filter(state == "CO") %>%
left_join(read_csv("output/results/co_pop_exposed.csv"), by = c("state", "year"))
ks_pop_exposed <-
read_csv("data/processed/wells_wildfire_state_year.csv") %>%
filter(state == "KS") %>%
left_join(read_csv("output/results/ks_pop_exposed.csv"), by = c("state", "year"))
la_pop_exposed <-
read_csv("data/processed/wells_wildfire_state_year.csv") %>%
filter(state == "LA") %>%
left_join(read_csv("output/results/la_pop_exposed.csv"), by = c("state", "year"))
mt_pop_exposed <-
read_csv("data/processed/wells_wildfire_state_year.csv") %>%
filter(state == "MT") %>%
left_join(read_csv("output/results/mt_pop_exposed.csv"), by = c("state", "year"))
nd_pop_exposed <-
read_csv("data/processed/wells_wildfire_state_year.csv") %>%
filter(state == "ND") %>%
left_join(read_csv("output/results/nd_pop_exposed.csv"), by = c("state", "year"))
ne_pop_exposed <-
read_csv("data/processed/wells_wildfire_state_year.csv") %>%
filter(state == "NE") %>%
left_join(read_csv("output/results/ne_pop_exposed.csv"), by = c("state", "year"))
nm_pop_exposed <-
read_csv("data/processed/wells_wildfire_state_year.csv") %>%
filter(state == "NM") %>%
left_join(read_csv("output/results/nm_pop_exposed.csv"), by = c("state", "year"))
ok_pop_exposed <-
read_csv("data/processed/wells_wildfire_state_year.csv") %>%
filter(state == "OK") %>%
left_join(read_csv("output/results/ok_pop_exposed.csv"), by = c("state", "year"))
tx_pop_exposed <-
read_csv("data/processed/wells_wildfire_state_year.csv") %>%
filter(state == "TX") %>%
left_join(read_csv("output/results/tx_pop_exposed.csv"), by = c("state", "year"))
ut_pop_exposed <-
read_csv("data/processed/wells_wildfire_state_year.csv") %>%
filter(state == "UT") %>%
left_join(read_csv("output/results/ut_pop_exposed.csv"), by = c("state", "year"))
wy_pop_exposed <-
read_csv("data/processed/wells_wildfire_state_year.csv") %>%
filter(state == "WY") %>%
left_join(read_csv("output/results/wy_pop_exposed.csv"), by = c("state", "year"))
#  binds with state-year exposure data, binds rows, then replaces NAs with 0s
pop_exposed_state_year <- ar_pop_exposed %>%
bind_rows(ca_pop_exposed) %>%
bind_rows(co_pop_exposed) %>%
bind_rows(ks_pop_exposed) %>%
bind_rows(la_pop_exposed) %>%
bind_rows(mt_pop_exposed) %>%
bind_rows(nd_pop_exposed) %>%
bind_rows(ne_pop_exposed) %>%
bind_rows(nm_pop_exposed) %>%
bind_rows(ok_pop_exposed) %>%
# bind_rows(sd_pop_exposed) %>%
bind_rows(tx_pop_exposed) %>%
bind_rows(ut_pop_exposed) %>%
bind_rows(wy_pop_exposed) %>%
mutate(pop_exposed = replace_na(pop_exposed, 0)) %>%
filter(year %in% c(1984:2019)) %>%
rename("pop_exposed_n" = "pop_exposed") %>%
select(state, year, pop_exposed_n)
# exports data
write_csv(pop_exposed_state_year, "data/processed/pop_exposed_state_year.csv")
##============================================================================##
# attaches necessary packages
source("code/0-setup/01-setup.R")
##### this is for GEOFACET package
#library("rgeos")  ##### apparently not available for MacOS, try on server
#library("geofacet")
library("viridis")
# data input
wells_kbdi <- readRDS("data/processed/wells_kbdi.rds")
wells_wildfire_state_year <-
read_csv("data/processed/wells_wildfire_state_year.csv")
pop_exposed_state_year <-
read_csv("data/processed/pop_exposed_state_year.csv")
rm(wells_kbdi)
gc()
# figure 3b ................................................................
# estimated total U.S. population within 1 km of oil and gas wells that were in
# wildfire burn areas by year
##### re-run once we have final data!
figure_3b <- pop_exposed_state_year %>%
filter(year %in% c(1984:2019)) %>%
filter(n_wells > 0) %>%
group_by(year) %>%
summarize(n = n()) %>%
ggplot()  +
geom_bar(aes(year, pop_exposed_n), stat = "identity") +
labs(x = "", y = "") +
theme_classic() +
theme(#axis.text.x  = element_blank(),
axis.text.y  = element_blank(),
legend.position = "none")
figure_3b
# figure 3b ................................................................
# estimated total U.S. population within 1 km of oil and gas wells that were in
# wildfire burn areas by year
##### re-run once we have final data!
figure_3b <- pop_exposed_state_year %>%
filter(year %in% c(1984:2019)) %>%
group_by(year) %>%
summarize(n = n()) %>%
ggplot()  +
geom_bar(aes(year, pop_exposed_n), stat = "identity") +
labs(x = "", y = "") +
theme_classic() +
theme(#axis.text.x  = element_blank(),
axis.text.y  = element_blank(),
legend.position = "none")
figure_3b
pop_exposed_state_year <-
read_csv("data/processed/pop_exposed_state_year.csv")
# figure 3b ................................................................
# estimated total U.S. population within 1 km of oil and gas wells that were in
# wildfire burn areas by year
##### re-run once we have final data!
figure_3b <- pop_exposed_state_year %>%
filter(year %in% c(1984:2019)) %>%
group_by(year) %>%
summarize(pop_exposed_n = sum(pop_exposed_n)) %>%
ggplot()  +
geom_bar(aes(year, pop_exposed_n), stat = "identity") +
labs(x = "", y = "") +
theme_classic() +
theme(#axis.text.x  = element_blank(),
axis.text.y  = element_blank(),
legend.position = "none")
figure_3b
# figure 3b ................................................................
# estimated total U.S. population within 1 km of oil and gas wells that were in
# wildfire burn areas by year
##### re-run once we have final data!
figure_3b <- pop_exposed_state_year %>%
filter(year %in% c(1984:2019)) %>%
group_by(year) %>%
summarize(pop_exposed_n = sum(pop_exposed_n)) %>%
ggplot()  +
geom_bar(aes(year, pop_exposed_n), stat = "identity") +
# labs(x = "", y = "") +
theme_classic() #+
figure_3b
# theme(#axis.text.x  = element_blank(),
#   axis.text.y  = element_blank(),
#   legend.position = "none")
# exports figures
ggsave(filename = "figure_3b.png", plot = figure_3b, device = "png",
height = 2.4, width = 4, path = "output/figures/components/")
# figure 3b ................................................................
# estimated total U.S. population within 1 km of oil and gas wells that were in
# wildfire burn areas by year
##### re-run once we have final data!
figure_3b <- pop_exposed_state_year %>%
filter(year %in% c(1984:2019)) %>%
group_by(year) %>%
summarize(pop_exposed_n = sum(pop_exposed_n)) %>%
ggplot()  +
geom_bar(aes(year, pop_exposed_n), stat = "identity") +
labs(x = "", y = "") +
theme_classic() #+
# figure 3b ................................................................
# estimated total U.S. population within 1 km of oil and gas wells that were in
# wildfire burn areas by year
##### re-run once we have final data!
figure_3b <- pop_exposed_state_year %>%
filter(year %in% c(1984:2019)) %>%
group_by(year) %>%
summarize(pop_exposed_n = sum(pop_exposed_n)) %>%
ggplot()  +
geom_bar(aes(year, pop_exposed_n), stat = "identity") +
labs(x = "", y = "") +
theme_classic() +
theme(#axis.text.x  = element_blank(),
axis.text.y  = element_blank(),
legend.position = "none")
# exports figures
ggsave(filename = "figure_3b.png", plot = figure_3b, device = "png",
height = 2.4, width = 4, path = "output/figures/components/")
##============================================================================##
## 2.13 - assembles human exposure data
## setup ---------------------------------------------------------------------
# attaches packages we need for this script
source("code/0-setup/01-setup.R")
## assemble dataset ----------------------------------------------------------
# imports previously-generated dataset with all state-years and joins
# state-year exposure data
ar_pop_exposed <-
read_csv("data/processed/wells_wildfire_state_year.csv") %>%
filter(state == "AR") %>%
left_join(read_csv("output/results/ar_pop_exposed.csv"), by = c("state", "year"))
ca_pop_exposed <-
read_csv("data/processed/wells_wildfire_state_year.csv") %>%
filter(state == "CA") %>%
left_join(read_csv("output/results/ca_pop_exposed.csv"), by = c("state", "year"))
co_pop_exposed <-
read_csv("data/processed/wells_wildfire_state_year.csv") %>%
filter(state == "CO") %>%
left_join(read_csv("output/results/co_pop_exposed.csv"), by = c("state", "year"))
ks_pop_exposed <-
read_csv("data/processed/wells_wildfire_state_year.csv") %>%
filter(state == "KS") %>%
left_join(read_csv("output/results/ks_pop_exposed.csv"), by = c("state", "year"))
la_pop_exposed <-
read_csv("data/processed/wells_wildfire_state_year.csv") %>%
filter(state == "LA") %>%
left_join(read_csv("output/results/la_pop_exposed.csv"), by = c("state", "year"))
mt_pop_exposed <-
read_csv("data/processed/wells_wildfire_state_year.csv") %>%
filter(state == "MT") %>%
left_join(read_csv("output/results/mt_pop_exposed.csv"), by = c("state", "year"))
nd_pop_exposed <-
read_csv("data/processed/wells_wildfire_state_year.csv") %>%
filter(state == "ND") %>%
left_join(read_csv("output/results/nd_pop_exposed.csv"), by = c("state", "year"))
ne_pop_exposed <-
read_csv("data/processed/wells_wildfire_state_year.csv") %>%
filter(state == "NE") %>%
left_join(read_csv("output/results/ne_pop_exposed.csv"), by = c("state", "year"))
nm_pop_exposed <-
read_csv("data/processed/wells_wildfire_state_year.csv") %>%
filter(state == "NM") %>%
left_join(read_csv("output/results/nm_pop_exposed.csv"), by = c("state", "year"))
ok_pop_exposed <-
read_csv("data/processed/wells_wildfire_state_year.csv") %>%
filter(state == "OK") %>%
left_join(read_csv("output/results/ok_pop_exposed.csv"), by = c("state", "year"))
tx_pop_exposed <-
read_csv("data/processed/wells_wildfire_state_year.csv") %>%
filter(state == "TX") %>%
left_join(read_csv("output/results/tx_pop_exposed.csv"), by = c("state", "year"))
ut_pop_exposed <-
read_csv("data/processed/wells_wildfire_state_year.csv") %>%
filter(state == "UT") %>%
left_join(read_csv("output/results/ut_pop_exposed.csv"), by = c("state", "year"))
wy_pop_exposed <-
read_csv("data/processed/wells_wildfire_state_year.csv") %>%
filter(state == "WY") %>%
left_join(read_csv("output/results/wy_pop_exposed.csv"), by = c("state", "year"))
#  binds with state-year exposure data, binds rows, then replaces NAs with 0s
pop_exposed_state_year <- ar_pop_exposed %>%
bind_rows(ca_pop_exposed) %>%
bind_rows(co_pop_exposed) %>%
bind_rows(ks_pop_exposed) %>%
bind_rows(la_pop_exposed) %>%
bind_rows(mt_pop_exposed) %>%
bind_rows(nd_pop_exposed) %>%
bind_rows(ne_pop_exposed) %>%
bind_rows(nm_pop_exposed) %>%
bind_rows(ok_pop_exposed) %>%
# bind_rows(sd_pop_exposed) %>%
bind_rows(tx_pop_exposed) %>%
bind_rows(ut_pop_exposed) %>%
bind_rows(wy_pop_exposed) %>%
mutate(pop_exposed = replace_na(pop_exposed, 0)) %>%
filter(year %in% c(1984:2019)) %>%
rename("pop_exposed_n" = "pop_exposed") %>%
select(state, year, pop_exposed_n)
# exports data
write_csv(pop_exposed_state_year, "data/processed/pop_exposed_state_year.csv")
##============================================================================##
# attaches packages we need for this script
source("code/0-setup/01-setup.R")
pop_exposed_state_year <- write_csv("data/processed/pop_exposed_state_year.csv")
pop_exposed_state_year <- read_csv("data/processed/pop_exposed_state_year.csv")
View(pop_exposed_state_year)
# attaches necessary packages
source("code/0-setup/01-setup.R")
##### this is for GEOFACET package
#library("rgeos")  ##### apparently not available for MacOS, try on server
#library("geofacet")
library("viridis")
# figure 3b ................................................................
# estimated total U.S. population within 1 km of oil and gas wells that were in
# wildfire burn areas by year
figure_3b <- pop_exposed_state_year %>%
filter(year %in% c(1984:2019)) %>%
group_by(year) %>%
summarize(pop_exposed_n = sum(pop_exposed_n)) %>%
ggplot()  +
geom_bar(aes(year, pop_exposed_n), stat = "identity") +
labs(x = "", y = "") +
theme_classic() +
theme(#axis.text.x  = element_blank(),
axis.text.y  = element_blank(),
legend.position = "none")
# exports figures
ggsave(filename = "figure_3b.png", plot = figure_3b, device = "png",
height = 2.4, width = 4, path = "output/figures/components/")
figure_3b
pop_exposed_state_year %>%
filter(year %in% c(1984:2019)) %>%
group_by(year) %>%
summarize(pop_exposed_n = sum(pop_exposed_n)) %>% View
# figure 3b ................................................................
# estimated total U.S. population within 1 km of oil and gas wells that were in
# wildfire burn areas by year
figure_3b <- pop_exposed_state_year %>%
filter(year %in% c(1984:2019)) %>%
group_by(year) %>%
summarize(pop_exposed_n = sum(pop_exposed_n)) %>%
ggplot()  +
geom_bar(aes(year, pop_exposed_n), stat = "identity") +
labs(x = "", y = "") +
theme_classic() #+
figure_3b
summary(pop_exposed_state_year)
# figure 3b ................................................................
# estimated total U.S. population within 1 km of oil and gas wells that were in
# wildfire burn areas by year
figure_3b <- pop_exposed_state_year %>%
group_by(year) %>%
summarize(pop_exposed_n = sum(pop_exposed_n)) %>%
ggplot()  +
geom_bar(aes(year, pop_exposed_n), stat = "identity") +
labs(x = "", y = "") +
theme_classic() +
theme(axis.text.x  = element_blank(),
axis.text.y  = element_blank(),
legend.position = "none")
# exports figures
ggsave(filename = "figure_3b.png", plot = figure_3b, device = "png",
height = 2.4, width = 4, path = "output/figures/components/")
figure_3b <- pop_exposed_state_year %>%
ggplot()  +
geom_bar(aes(year, pop_exposed_n), stat = "identity") +
labs(x = "", y = "") +
theme_classic() +
facet_wrap(~ state)
figure_3b <- pop_exposed_state_year %>%
group_by(year) %>%
summarize(pop_exposed_n = sum(pop_exposed_n)) %>%
ggplot()  +
geom_bar(aes(year, pop_exposed_n), stat = "identity") +
labs(x = "", y = "") +
theme_classic()
figure_3b
figure_3b <- pop_exposed_state_year %>%
ggplot()  +
geom_bar(aes(year, pop_exposed_n), stat = "identity") +
labs(x = "", y = "") +
theme_classic() +
facet_wrap(~ state)
figure_3b
View(pop_exposed_state_year)
summary(pop_exposed_state_year)
summary(as.factor(pop_exposed_state_year$state))
##============================================================================##
## 2.13 - assembles human exposure data
## setup ---------------------------------------------------------------------
# attaches packages we need for this script
source("code/0-setup/01-setup.R")
## assemble dataset ----------------------------------------------------------
# imports previously-generated dataset with all state-years and joins
# state-year exposure data
ar_pop_exposed <-
read_csv("data/processed/wells_wildfire_state_year.csv") %>%
filter(state == "AR") %>%
left_join(read_csv("output/results/ar_pop_exposed.csv"), by = c("state", "year"))
ca_pop_exposed <-
read_csv("data/processed/wells_wildfire_state_year.csv") %>%
filter(state == "CA") %>%
left_join(read_csv("output/results/ca_pop_exposed.csv"), by = c("state", "year"))
co_pop_exposed <-
read_csv("data/processed/wells_wildfire_state_year.csv") %>%
filter(state == "CO") %>%
left_join(read_csv("output/results/co_pop_exposed.csv"), by = c("state", "year"))
ks_pop_exposed <-
read_csv("data/processed/wells_wildfire_state_year.csv") %>%
filter(state == "KS") %>%
left_join(read_csv("output/results/ks_pop_exposed.csv"), by = c("state", "year"))
la_pop_exposed <-
read_csv("data/processed/wells_wildfire_state_year.csv") %>%
filter(state == "LA") %>%
left_join(read_csv("output/results/la_pop_exposed.csv"), by = c("state", "year"))
mt_pop_exposed <-
read_csv("data/processed/wells_wildfire_state_year.csv") %>%
filter(state == "MT") %>%
left_join(read_csv("output/results/mt_pop_exposed.csv"), by = c("state", "year"))
nd_pop_exposed <-
read_csv("data/processed/wells_wildfire_state_year.csv") %>%
filter(state == "ND") %>%
left_join(read_csv("output/results/nd_pop_exposed.csv"), by = c("state", "year"))
ne_pop_exposed <-
read_csv("data/processed/wells_wildfire_state_year.csv") %>%
filter(state == "NE") %>%
left_join(read_csv("output/results/ne_pop_exposed.csv"), by = c("state", "year"))
nm_pop_exposed <-
read_csv("data/processed/wells_wildfire_state_year.csv") %>%
filter(state == "NM") %>%
left_join(read_csv("output/results/nm_pop_exposed.csv"), by = c("state", "year"))
ok_pop_exposed <-
read_csv("data/processed/wells_wildfire_state_year.csv") %>%
filter(state == "OK") %>%
left_join(read_csv("output/results/ok_pop_exposed.csv"), by = c("state", "year"))
tx_pop_exposed <-
read_csv("data/processed/wells_wildfire_state_year.csv") %>%
filter(state == "TX") %>%
left_join(read_csv("output/results/tx_pop_exposed.csv"), by = c("state", "year"))
ut_pop_exposed <-
read_csv("data/processed/wells_wildfire_state_year.csv") %>%
filter(state == "UT") %>%
left_join(read_csv("output/results/ut_pop_exposed.csv"), by = c("state", "year"))
wy_pop_exposed <-
read_csv("data/processed/wells_wildfire_state_year.csv") %>%
filter(state == "WY") %>%
left_join(read_csv("output/results/wy_pop_exposed.csv"), by = c("state", "year"))
#  binds with state-year exposure data, binds rows, then replaces NAs with 0s
pop_exposed_state_year <- ar_pop_exposed %>%
bind_rows(ca_pop_exposed) %>%
bind_rows(co_pop_exposed) %>%
bind_rows(ks_pop_exposed) %>%
bind_rows(la_pop_exposed) %>%
bind_rows(mt_pop_exposed) %>%
bind_rows(nd_pop_exposed) %>%
bind_rows(ne_pop_exposed) %>%
bind_rows(nm_pop_exposed) %>%
bind_rows(ok_pop_exposed) %>%
# bind_rows(sd_pop_exposed) %>%
bind_rows(tx_pop_exposed) %>%
bind_rows(ut_pop_exposed) %>%
bind_rows(wy_pop_exposed) %>%
mutate(pop_exposed = replace_na(pop_exposed, 0)) %>%
filter(year %in% c(1984:2019)) %>%
rename("pop_exposed_n" = "pop_exposed") %>%
select(state, year, pop_exposed_n)
# exports data
write_csv(pop_exposed_state_year, "data/processed/pop_exposed_state_year.csv")
##============================================================================##
# attaches necessary packages
source("code/0-setup/01-setup.R")
##### this is for GEOFACET package
#library("rgeos")  ##### apparently not available for MacOS, try on server
#library("geofacet")
library("viridis")
# data input
wells_kbdi <- readRDS("data/processed/wells_kbdi.rds")
wells_wildfire_state_year <-
read_csv("data/processed/wells_wildfire_state_year.csv")
pop_exposed_state_year <-
read_csv("data/processed/pop_exposed_state_year.csv")
# figure 3b ................................................................
# estimated total U.S. population within 1 km of oil and gas wells that were in
# wildfire burn areas by year
figure_3b <- pop_exposed_state_year %>%
group_by(year) %>%
summarize(pop_exposed_n = sum(pop_exposed_n)) %>%
ggplot()  +
geom_bar(aes(year, pop_exposed_n), stat = "identity") +
labs(x = "", y = "") +
theme_classic() +
theme(axis.text.x  = element_blank(),
axis.text.y  = element_blank(),
legend.position = "none")
# exports figures
ggsave(filename = "figure_3b.png", plot = figure_3b, device = "png",
height = 2.4, width = 4, path = "output/figures/components/")
figure_3b
# figure 3b ................................................................
# estimated total U.S. population within 1 km of oil and gas wells that were in
# wildfire burn areas by year
figure_3b <- pop_exposed_state_year %>%
group_by(year) %>%
summarize(pop_exposed_n = sum(pop_exposed_n)) %>%
ggplot()  +
geom_bar(aes(year, pop_exposed_n), stat = "identity") +
labs(x = "", y = "") +
theme_classic() #+
# figure 3b ................................................................
# estimated total U.S. population within 1 km of oil and gas wells that were in
# wildfire burn areas by year
figure_3b <- pop_exposed_state_year %>%
group_by(year) %>%
summarize(pop_exposed_n = sum(pop_exposed_n)) %>%
ggplot()  +
geom_bar(aes(year, pop_exposed_n), stat = "identity") +
labs(x = "", y = "") +
theme_classic() +
theme(axis.text.x  = element_blank(),
axis.text.y  = element_blank(),
legend.position = "none")
pop_exposed_state_year %>%
group_by(year) %>%
summarize(pop_exposed_n = sum(pop_exposed_n)) %>%
ggplot()  +
geom_bar(aes(year, pop_exposed_n), stat = "identity") +
labs(x = "", y = "") +
theme_classic()
pop_exposed_state_year %>%
ggplot()  +
geom_bar(aes(year, pop_exposed_n), stat = "identity") +
labs(x = "", y = "") +
theme_classic() +
theme(axis.text.x  = element_blank(),
axis.text.y  = element_blank(),
legend.position = "none") +
facet_wrap(~ state)
pop_exposed_state_year %>%
group_by(state) %>%
summarize(pop_exposed_n = sum(pop_exposed_n)) %>% View()
pop_exposed_state_year %>%
group_by(state) %>%
summarize(pop_exposed_n = round(sum(pop_exposed_n), digits = 0)) %>% View()
round(sum(pop_exposed_state_year$pop_exposed_n), digits = 0)
pop_exposed_state_year %>%
group_by(year) %>%
summarize(pop_exposed_n = round(sum(pop_exposed_n), digits = 0)) %>% View()
# attaches necessary packages
source("code/0-setup/01-setup.R")
pop_exposed_state_year <-
read_csv("data/processed/pop_exposed_state_year.csv")
sum(pop_exposed_state_year$pop_exposed_n)
