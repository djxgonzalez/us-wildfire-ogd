# loads necessary packages and defines global variables
source("code/0-setup/01-setup.R")
# loads necessary packages and defines global variables
source("code/0-setup/01-setup.R")
enverus_wells <- readRDS("data/interim/enverus_wells.rds")
glimpse(enverus_wells)
summary(as.factor(enverus_wells$state))
##---------------------------------------------------------------------------
## sets up environment
library("ggrepel")
library("ggspatial")
# data input, prep layers for mapping ......................................
us_states_west <- st_read("data/raw/us_census/tl_2018_us_state.shp") %>%
filter(STUSPS %in% c("AK", "WA", "OR", "CA", "ID", "NV", "AZ", "MT", "WY",
"UT", "CO", "NM", "ND", "SD", "NE", "KS", "OK", "TX")) %>%
st_geometry() %>%
st_transform(crs_nad83)
library("usethis")
library("ncdf4")
library("graphics")
library("usethis")
library("tidync")
library("viridis")
# attaches generally needed packages
library("sf")
library("tidyverse")
library("RColorBrewer")
library("viridis")
# spring
nc_spring_2017 <-
nc_open("data/raw/KBDI_Wildfire_Gas/KBDI/2017/Mean_KBDI_Spring_2017.nc")
# spring
nc_spring_2017 <-
nc_open("data/raw/kbdi_wildfire_risk/KBDI/2017/Mean_KBDI_Spring_2017.nc")
nc_fall_2017 <-
nc_open("data/raw/kbdi_wildfire_risk/KBDI/2017/Mean_KBDI_Fall_2017.nc")
# loads necessary packages and defines global variables
source("code/0-setup/01-setup.R")
# spring
nc_spring_2017 <-
nc_open("data/raw/kbdi_wildfire_risk/KBDI/2017/Mean_KBDI_Spring_2017.nc")
# attaches packages we need for this script
library("ncdf4")
library("graphics")
library("usethis")
library("raster")
library("tidync")
# spring
# nc_spring_2017 <-
#   nc_open("data/raw/kbdi_wildfire_risk/KBDI/2017/Mean_KBDI_Spring_2017.nc")
# nc_summer_2017 <-
#   nc_open("data/raw/kbdi_wildfire_risk/KBDI/2017/Mean_KBDI_Summer_2017.nc")
nc_fall_2017 <-
nc_open("data/raw/kbdi_wildfire_risk/KBDI/2017/Mean_KBDI_Fall_2017.nc")
# get longitude and latitude
lon <- ncvar_get(nc_fall_2017,"lon")
nlon <- dim(lon)
print(nc_fall_2017)
# spring
# nc_spring_2017 <-
#   nc_open("data/raw/kbdi_wildfire_risk/KBDI/2017/Mean_KBDI_Spring_2017.nc")
# nc_summer_2017 <-
#   nc_open("data/raw/kbdi_wildfire_risk/KBDI/2017/Mean_KBDI_Summer_2017.nc")
nc_fall_2017 <-
nc_open("data/raw/kbdi_wildfire_risk/KBDI/2017/Mean_KBDI_Fall_2017.nc")
print(nc_fall_2017)
# loads necessary packages and defines global variables
source("code/0-setup/01-setup.R")
# set path and filename
ncpath <- "data/"
ncname2 <- "WRFlatlon"
ncfname2 <- paste(ncpath, ncname2, ".nc", sep="")
dname2 <- "wfirelatlong"
# open a netCDF file
ncin2 <- nc_open(ncfname2)
#Read in nc file
library(ncdf4)
3library(tidyverse)
#Read in nc file
library(ncdf4)
library(tidyverse)
library(graphics)
library(RColorBrewer)
library(usethis)
library(raster)
library(tidync)
library(sf)
library(viridis)
dname2 <- "wfirelatlong"
# open a netCDF file
ncin2 <- nc_open(ncfname2)
print(ncin2)
# attaches packages we need for this script
library("ncdf4")
library("graphics")
library("usethis")
library("raster")
library("tidync")
# spring
# nc_spring_2017 <-
#   nc_open("data/raw/kbdi_wildfire_risk/KBDI/2017/Mean_KBDI_Spring_2017.nc")
# nc_summer_2017 <-
#   nc_open("data/raw/kbdi_wildfire_risk/KBDI/2017/Mean_KBDI_Summer_2017.nc")
nc_fall_2017 <-
nc_open("data/raw/kbdi_wildfire_risk/KBDI/2017/Mean_KBDI_Fall_2017.nc")
nc_fall_20190 <-
nc_open("data/Mean_KBDI_Fall_2086-2094.nc")
nc_fall_2090 <-
nc_open("data/Mean_KBDI_Fall_2086-2094_R8Y8.nc")
print(nc_fall_2017)
# get longitude and latitude
lon <- ncvar_get(nc_fall_2017,"lon")
print(nc_fall_2090)
lon <- ncvar_get(nc_fall_2090,"lon")
print(nc_fall_2090)
install.packages"(netcdf4"
install.packages("netcdf4")
install.packages("ncdf4")
install.packages("ncdf4")
# loads necessary packages and defines global variables
source("code/0-setup/01-setup.R")
# attaches functions for tidying raw data
source("code/1-data_tidying/01-tidy_enverus_data.R")
# imports raw data, calls tidying functions, exports interim data
source("code/1-data_tidying/04-call_data_tidying.R")
# attaches packages we need for this script
library("ncdf4")
library("graphics")
library("usethis")
library("raster")
library("tidync")
nc_fall_2090 <-
nc_open("data/Mean_KBDI_Fall_2086-2094_R8Y8.nc")
print(nc_fall_2090)
# set path and filename
ncpath <- "data/raw/kbdi_wildfier_risk/KBDI/EndCen/"
# loads necessary packages and defines global variables
source("code/0-setup/01-setup.R")
# attaches packages we need for this script
library("ncdf4")
library("graphics")
library("usethis")
library("raster")
library("tidync")
#Read in nc file
library(ncdf4)
library(tidyverse)
library(graphics)
library(RColorBrewer)
library(usethis)
library(raster)
library(tidync)
library(sf)
library(viridis)
# set path and filename
ncpath <- "data/raw/kbdi_wildfier_risk/KBDI/EndCen/"
ncname2 <- "WRFlatlon"
ncfname2 <- paste(ncpath, ncname2, ".nc", sep="")
dname2 <- "wfirelatlong"
# open a netCDF file
ncin2 <- nc_open(ncfname2)
# set path and filename
ncpath <- "data/raw/kbdi_wildfire_risk/KBDI/EndCen/"
ncname2 <- "WRFlatlon"
ncfname2 <- paste(ncpath, ncname2, ".nc", sep="")
dname2 <- "wfirelatlong"
# open a netCDF file
ncin2 <- nc_open(ncfname2)
print(ncin2)
# get longitude and latitude
lon <- ncvar_get(ncin2,"lon")
nlon <- dim(lon)
head(lon)
lat <- ncvar_get(ncin2,"lat")
nlat <- dim(lat)
head(lat)
# set path and filename
#ncpath <- "~/Desktop/joan-nc/"
ncname <- "Mean_KBDI_Summer_2086-2094_R8Y8"
ncfname <- paste(ncpath, ncname, ".nc", sep="")
dname <- "KBDI"
# open a netCDF file
ncin <- nc_open(ncfname)
print(ncin)
#read in wildfire raster
wf_raster <- raster(ncfname)
plot(wf_raster)
# get wildfire risk variable
tmp_array <- ncvar_get(ncin,dname)
dlname <- ncatt_get(ncin,dname,"long_name")
dunits <- ncatt_get(ncin,dname,"units")
fillvalue <- ncatt_get(ncin,dname,"_FillValue") # fills as na which is what we would want
dim(tmp_array)
x <- as.vector(lon)
y <- as.vector(lat)
z <- as.vector(wf_risk)
xyz <- as.data.frame(cbind(x=x, y=y,z=z))
wf_risk <- ggplot(data = xyz,aes(x = x, y = y, fill = z)) +
geom_point()
wf_risk
# get wildfire risk variable
tmp_array <- ncvar_get(ncin,dname)
dlname <- ncatt_get(ncin,dname,"long_name")
dunits <- ncatt_get(ncin,dname,"units")
fillvalue <- ncatt_get(ncin,dname,"_FillValue") # fills as na which is what we would want
dim(tmp_array)
wf_risk <- tmp_array
x <- as.vector(lon)
y <- as.vector(lat)
z <- as.vector(wf_risk)
xyz <- as.data.frame(cbind(x=x, y=y,z=z))
wf_risk <- ggplot(data = xyz,aes(x = x, y = y, fill = z)) +
geom_point()
wf_risk
WRFlatlon <- nc_open("data/raw/kbdi_wildfire_risk/KBDI/EndCen/WRFlatlon.nc")
rm(x)
rm(y)
rm(z)
rm(xyz)
# loads necessary packages and defines global variables
source("code/0-setup/01-setup.R")
# attaches packages we need for this script
library("ncdf4")
library("graphics")
library("usethis")
library("raster")
library("tidync")
# data input ...............................................................
latlon_2017 <- nc_open("data/raw/kbdi_wildfire_risk/KBDI/2017/PRISMlatlon.nc")
nc_spring_2017 <-
nc_open("data/raw/kbdi_wildfire_risk/KBDI/2017/Mean_KBDI_Spring_2017.nc")
nc_summer_2017 <-
nc_open("data/raw/kbdi_wildfire_risk/KBDI/2017/Mean_KBDI_Summer_2017.nc")
nc_fall_2017 <-
nc_open("data/raw/kbdi_wildfire_risk/KBDI/2017/Mean_KBDI_Fall_2017.nc")
# data prep ................................................................
lon <- ncvar_get(latlon_2017, "lon")
nlon <- dim(lon)
head(lon)
wf_raster <- raster("data/raw/kbdi_wildfire_risk/KBDI/2017/Mean_KBDI_Spring_2017.nc")
plot(wf_raster)
# get wildfire risk variable
tmp_array <- ncvar_get(ncin, dname)
latlon_2017
kbdi_2017_spring <-
as.data.frame(cbind(lon  = ncvar_get(latlon_2017,    "lon"),
lat  = ncvar_get(latlon_2017,    "lat"),
kbdi = ncvar_get(nc_spring_2017, "KBDI")))
lon  = ncvar_get(latlon_2017,    "lon")
dim(lon)
lat  = ncvar_get(latlon_2017,    "lat")
dim(lat)
lon_2017  = ncvar_get(latlon_2017, "lon"),
lat_2017  = ncvar_get(latlon_2017, "lat"),
kbdi_2017_spring <-
as.data.frame(cbind(
kbdi = ncvar_get(nc_spring_2017, "KBDI")))
lon_2017  = ncvar_get(latlon_2017, "lon")
lat_2017  = ncvar_get(latlon_2017, "lat")
kbdi_2017_spring <-
as.data.frame(cbind(lon  = lon,
lat  = lat,
kbdi = ncvar_get(nc_spring_2017, "KBDI")))
lon_2017  = ncvar_get(latlon_2017, "lon")
lat_2017  = ncvar_get(latlon_2017, "lat")
kbdi_2017_spring = ncvar_get(nc_spring_2017, "KBDI")
kbdi_2017_spring <- as.data.frame(cbind(lon  = lon,
lat  = lat,
kbdi = kbdi_2017_spring))
View(kbdi_2017_spring)
ggplot(data = kbdi_2017_spring) +
geom_point(aes(x = lon, y = lat, fill = kbdi))
kbdi_2017_spring <- ncvar_get(nc_spring_2017, "KBDI")
kbdi_2017_spring <- as.data.frame(cbind(lon  = lon,
lat  = lat,
kbdi = kbdi_2017_spring))
kbdi_2017_spring
View(kbdi_2017_spring)
lon_2017  <- ncvar_get(latlon_2017, "lon")
lat_2017  <- ncvar_get(latlon_2017, "lat")
kbdi_2017_spring <- ncvar_get(nc_spring_2017, "KBDI")
View(kbdi_2017_spring)
# set path and filename
ncpath <- "data/raw/kbdi_wildfire_risk/KBDI/EndCen/"
ncname2 <- "WRFlatlon"
ncfname2 <- paste(ncpath, ncname2, ".nc", sep="")
dname2 <- "wfirelatlong"
# open a netCDF file
ncin2 <- nc_open(ncfname2)
print(ncin2)
# get longitude and latitude
lon <- ncvar_get(ncin2,"lon")
nlon <- dim(lon)
head(lon)
lat <- ncvar_get(ncin2,"lat")
nlat <- dim(lat)
head(lat)
# set path and filename
#ncpath <- "~/Desktop/joan-nc/"
ncname <- "Mean_KBDI_Summer_2086-2094_R8Y8"
ncfname <- paste(ncpath, ncname, ".nc", sep="")
dname <- "KBDI"
# open a netCDF file
ncin <- nc_open(ncfname)
print(ncin)
#read in wildfire raster
wf_raster <- raster(ncfname)
plot(wf_raster)
# get wildfire risk variable
tmp_array <- ncvar_get(ncin,dname)
dlname <- ncatt_get(ncin,dname,"long_name")
dunits <- ncatt_get(ncin,dname,"units")
fillvalue <- ncatt_get(ncin,dname,"_FillValue") # fills as na which is what we would want
dim(tmp_array)
wf_risk <- tmp_array
x <- as.vector(lon)
y <- as.vector(lat)
z <- as.vector(wf_risk)
xyz <- as.data.frame(cbind(x=x, y=y,z=z))
wf_risk <- ggplot(data = xyz,aes(x = x, y = y, fill = z)) +
geom_point()
wf_risk
lon_2017  <- ncvar_get(latlon_2017, "lon") %>% as.vector
lat_2017  <- ncvar_get(latlon_2017, "lat") %>% as.vector
kbdi_2017_spring <- ncvar_get(nc_spring_2017, "KBDI") %>% as.vector
# kbdi_2017_spring <- as.data.frame(cbind(lon  = lon,
#                                         lat  = lat,
#                                         kbdi = kbdi_2017_spring))
kbdi_2017_spring <- as.data.frame(cbind(lon  = lon,
lat  = lat,
kbdi = kbdi_2017_spring))
kbdi_2017_spring
View(kbdi_2017_spring)
source("../../code/0-setup/01-setup.R")
library("ncdf4")
library("raster")
library("RColorBrewer")
nc_spring_2017 <-
nc_open("../../data/raw/KBDI_Wildfire_Gas/KBDI/2017/Mean_KBDI_Spring_2017.nc")
source("../../code/0-setup/01-setup.R")
library("ncdf4")
library("raster")
library("RColorBrewer")
us_states_west <- st_read("../../data/raw/us_census/tl_2018_us_state.shp") %>%
filter(STUSPS %in% c("AK", "WA", "OR", "CA", "ID", "NV", "AZ", "MT", "WY",
"UT", "CO", "NM", "ND", "SD", "NE", "KS", "OK", "TX"))
us_states_west <- st_read("../../data/raw/us_census/tl_2018_us_state.shp") %>%
filter(STUSPS %in% c("AK", "WA", "OR", "CA", "ID", "NV", "AZ", "MT", "WY",
"UT", "CO", "NM", "ND", "SD", "NE", "KS", "OK", "TX"))
us_states_west_mask <- us_states_west %>% st_union() %>% st_geometry()
us_states_west <- st_read("../../data/raw/us_census/tl_2018_us_state.shp") %>%
filter(STUSPS %in% c("AK", "WA", "OR", "CA", "ID", "NV", "AZ", "MT", "WY",
"UT", "CO", "NM", "ND", "SD", "NE", "KS", "OK", "TX",
"MN", "IA", "MO", "AR", "LA"))
us_states_west_mask <- us_states_west %>% st_union() %>% st_geometry()
plot(us_states_west_mask)
nc_spring_2017 <-
nc_open("../../data/raw/KBDI_Wildfire_Gas/KBDI/2017/Mean_KBDI_Spring_2017.nc")
nc_spring_2017 <-
nc_open("../../data/raw/kbdi_wildfire_risk/KBDI/2017/Mean_KBDI_Spring_2017.nc")
# nc_summer_2017 <-
#   nc_open("../../data/raw/kbdi_wildfire_risk/KBDI/2017/Mean_KBDI_Summer_2017.nc")
# nc_fall_2017 <-
#   nc_open("../../data/raw/kbdi_wildfire_risk/KBDI/2017/Mean_KBDI_Fall_2017.nc")
kbdi_spring_2017 <- ncvar_get(nc_spring_2017, "KBDI")
kbdi_spring_2017[is.nan(kbdi_spring_2017)] <- NA  # replaces NaN with NA
kbdi_spring_2017_raster <-
raster(t(kbdi_spring_2017),
crs = CRS("+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs +
towgs84=0,0,0")) %>%
flip(direction = "y")
lon_spring_2017  <- ncvar_get(nc_spring_2017, varid = "longitude",
verbose = T)
#attributes(nc_spring_2017$dim)$names[1])
#nc_spring_2017$dim$longitude)
kbdi_summer_2017 <- ncvar_get(nc_summer_2017, "KBDI")
install.packages("rmarkdown")
install.packages("rmarkdown")
source("../../code/0-setup/01-setup.R")
library("ncdf4")
library("raster")
library("RColorBrewer")
us_states_west <- st_read("../../data/raw/us_census/tl_2018_us_state.shp") %>%
filter(STUSPS %in% c("AK", "WA", "OR", "CA", "ID", "NV", "AZ", "MT", "WY",
"UT", "CO", "NM", "ND", "SD", "NE", "KS", "OK", "TX",
"MN", "IA", "MO", "AR", "LA"))
us_states_west_mask <- us_states_west %>% st_union() %>% st_geometry()
latlon_2017 <- nc_open("data/raw/kbdi_wildfire_risk/KBDI/2017/PRISMlatlon.nc")
