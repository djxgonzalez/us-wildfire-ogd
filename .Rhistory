filter(STATE %in% c("OR", "CA", "NV", "AZ", "MT", "WY", "UT", "CO", "NM",
"ND", "SD", "NE", "KS", "OK", "TX", "MO", "AR", "LA")) %>%
st_transform(crs_albers) %>%
st_union()
federal_land<-federal_lands
fed_land <- federal_land
rm(federal_land)
# figure 3a ................................................................
figure_3a <- ggplot() +
geom_sf(data = mex_can,   color = NA, fill = "#D4D4D4", alpha = 0.8) +
geom_sf(data = us_states, color = NA, fill = "#E5E5E5", alpha = 0.7) +
# geom_sf(data = kbdi_450_2017, shape = 15, color = "#AD8ABB", size = 0.0001) +
geom_sf(data = us_states_excluded, color = NA, fill = "#D4D4D4") +
geom_sf(data = us_states,   color = "white", fill = NA, lwd = 0.2) +
geom_sf(data = us_boundary, color = "white", fill = NA, lwd = 0.3) +
geom_sf(data = federal_land, fill = "#91cf60", color = NA, alpha = 0.6) +
# geom_sf(data = wells_all_buffer_1km, fill = "black", color = NA, alpha = 0.6) +
xlim(-2300000, 560000) + ylim(340000, 3100000) +  # origin: 96W, 23N
labs(x = "", y = "") +
theme_void() +
theme(panel.background = element_rect(fill  = "#e9f5f8"),
panel.grid       = element_line(color = "#e9f5f8"),
legend.position = "none")
# figure 3a ................................................................
figure_3a <- ggplot() +
geom_sf(data = mex_can,   color = NA, fill = "#D4D4D4", alpha = 0.8) +
geom_sf(data = us_states, color = NA, fill = "#E5E5E5", alpha = 0.7) +
# geom_sf(data = kbdi_450_2017, shape = 15, color = "#AD8ABB", size = 0.0001) +
geom_sf(data = us_states_excluded, color = NA, fill = "#D4D4D4") +
geom_sf(data = us_states,   color = "white", fill = NA, lwd = 0.2) +
geom_sf(data = us_boundary, color = "white", fill = NA, lwd = 0.3) +
geom_sf(data = fed_land, fill = "#91cf60", color = NA, alpha = 0.6) +
# geom_sf(data = wells_all_buffer_1km, fill = "black", color = NA, alpha = 0.6) +
xlim(-2300000, 560000) + ylim(340000, 3100000) +  # origin: 96W, 23N
labs(x = "", y = "") +
theme_void() +
theme(panel.background = element_rect(fill  = "#e9f5f8"),
panel.grid       = element_line(color = "#e9f5f8"),
legend.position = "none")
figure_3a
# figure 3a ................................................................
figure_3a <- ggplot() +
geom_sf(data = mex_can,   color = NA, fill = "#D4D4D4", alpha = 0.8) +
geom_sf(data = us_states, color = NA, fill = "#E5E5E5", alpha = 0.7) +
geom_sf(data = kbdi_450_2017, shape = 15, color = "#AD8ABB", size = 0.0001) +
geom_sf(data = us_states_excluded, color = NA, fill = "#D4D4D4") +
geom_sf(data = us_states,   color = "white", fill = NA, lwd = 0.2) +
geom_sf(data = us_boundary, color = "white", fill = NA, lwd = 0.3) +
geom_sf(data = fed_land, fill = "#91cf60", color = NA, alpha = 0.6) +
geom_sf(data = wells_all_buffer_1km, fill = "black", color = NA, alpha = 0.6) +
xlim(-2300000, 560000) + ylim(340000, 3100000) +  # origin: 96W, 23N
labs(x = "", y = "") +
theme_void() +
theme(panel.background = element_rect(fill  = "#e9f5f8"),
panel.grid       = element_line(color = "#e9f5f8"),
legend.position = "none")
# export
ggsave(filename = "figure_3a.png", plot = figure_3a, device = "png",
height = 4.818, width = 5, path = "output/figures/components/")
# figure 3b ................................................................
figure_3b <- ggplot() +
geom_sf(data = mex_can,   color = NA, fill = "#D4D4D4", alpha = 0.8) +
geom_sf(data = us_states, color = NA, fill = "#E5E5E5", alpha = 0.7) +
geom_sf(data = kbdi_450_2050, shape = 15, color = "#AD8ABB", size = 0.4) +
geom_sf(data = us_states_excluded, color = NA, fill = "#D4D4D4") +
geom_sf(data = us_states,   color = "white", fill = NA, lwd = 0.2) +
geom_sf(data = us_boundary, color = "white", fill = NA, lwd = 0.3) +
geom_sf(data = fed_land, fill = "#91cf60", color = NA, alpha = 0.6) +
geom_sf(data = wells_all_buffer_1km, fill = "black", color = NA, alpha = 0.6) +
xlim(-2300000, 560000) + ylim(340000, 3100000) +  # origin: 96W, 23N
labs(x = "", y = "") +
theme_void() +
theme(panel.background = element_rect(fill  = "#e9f5f8"),
panel.grid       = element_line(color = "#e9f5f8"),
legend.position = "none")
# export
ggsave(filename = "figure_3b.png", plot = figure_3b, device = "png",
height = 4.818, width = 5, path = "output/figures/components/")
# figure 3c ................................................................
figure_3c <- ggplot() +
geom_sf(data = mex_can,   color = NA, fill = "#D4D4D4", alpha = 0.8) +
geom_sf(data = us_states, color = NA, fill = "#E5E5E5", alpha = 0.7) +
geom_sf(data = kbdi_450_2090, shape = 15, color = "#AD8ABB", size = 0.4) +
geom_sf(data = us_states_excluded, color = NA, fill = "#D4D4D4") +
geom_sf(data = us_states,   color = "white", fill = NA, lwd = 0.2) +
geom_sf(data = us_boundary, color = "white", fill = NA, lwd = 0.3) +
geom_sf(data = fed_land, fill = "#91cf60", color = NA, alpha = 0.6) +
geom_sf(data = wells_all_buffer_1km, fill = "black", color = NA, alpha = 0.6) +
xlim(-2300000, 560000) + ylim(340000, 3100000) +  # origin: 96W, 23N
labs(x = "", y = "") +
theme_void() +
theme(panel.background = element_rect(fill  = "#e9f5f8"),
panel.grid       = element_line(color = "#e9f5f8"),
legend.position = "none")
# export
ggsave(filename = "figure_3c.png", plot = figure_3c, device = "png",
height = 4.818, width = 5, path = "output/figures/components/")
# figure 3d ................................................................
figure_3d <- ggplot() +
geom_sf(data = mex_can,   color = NA, fill = "#D4D4D4", alpha = 0.8) +
geom_sf(data = us_states, color = NA, fill = "#E5E5E5", alpha = 0.7) +
geom_sf(data = kbdi_600_2017, shape = 15, color = "#F0A3D0", size = 0.0001) +
geom_sf(data = us_states_excluded, color = NA, fill = "#D4D4D4") +
geom_sf(data = us_states,   color = "white", fill = NA, lwd = 0.2) +
geom_sf(data = us_boundary, color = "white", fill = NA, lwd = 0.3) +
geom_sf(data = fed_land, fill = "#91cf60", color = NA, alpha = 0.6) +
geom_sf(data = wells_all_buffer_1km, fill = "black", color = NA, alpha = 0.6) +
xlim(-2300000, 560000) + ylim(340000, 3100000) +  # origin: 96W, 23N
labs(x = "", y = "") +
theme_void() +
theme(panel.background = element_rect(fill  = "#e9f5f8"),
panel.grid       = element_line(color = "#e9f5f8"),
legend.position = "none")
# export
ggsave(filename = "figure_3d.png", plot = figure_3d, device = "png",
height = 4.818, width = 5, path = "output/figures/components/")
# figure 3e ................................................................
figure_3e <- ggplot() +
geom_sf(data = mex_can,   color = NA, fill = "#D4D4D4", alpha = 0.8) +
geom_sf(data = us_states, color = NA, fill = "#E5E5E5", alpha = 0.7) +
geom_sf(data = kbdi_600_2050, shape = 15, color = "#F0A3D0", size = 0.4) +
geom_sf(data = us_states_excluded, color = NA, fill = "#D4D4D4") +
geom_sf(data = us_states,   color = "white", fill = NA, lwd = 0.2) +
geom_sf(data = us_boundary, color = "white", fill = NA, lwd = 0.3) +
geom_sf(data = fed_land, fill = "#91cf60", color = NA, alpha = 0.6) +
geom_sf(data = wells_all_buffer_1km, fill = "black", color = NA, alpha = 0.6) +
xlim(-2300000, 560000) + ylim(340000, 3100000) +  # origin: 96W, 23N
labs(x = "", y = "") +
theme_void() +
theme(panel.background = element_rect(fill  = "#e9f5f8"),
panel.grid       = element_line(color = "#e9f5f8"),
legend.position = "none")
# export
ggsave(filename = "figure_3e.png", plot = figure_3e, device = "png",
height = 4.818, width = 5, path = "output/figures/components/")
# figure 3f ................................................................
figure_3f <- ggplot() +
geom_sf(data = mex_can,   color = NA, fill = "#D4D4D4", alpha = 0.8) +
geom_sf(data = us_states, color = NA, fill = "#E5E5E5", alpha = 0.7) +
geom_sf(data = kbdi_600_2090, shape = 15, color = "#F0A3D0", size = 0.4) +
geom_sf(data = us_states_excluded, color = NA, fill = "#D4D4D4") +
geom_sf(data = us_states,   color = "white", fill = NA, lwd = 0.2) +
geom_sf(data = us_boundary, color = "white", fill = NA, lwd = 0.3) +
geom_sf(data = fed_land, fill = "#91cf60", color = NA, alpha = 0.6) +
geom_sf(data = wells_all_buffer_1km, fill = "black", color = NA, alpha = 0.6) +
xlim(-2300000, 560000) + ylim(340000, 3100000) +  # origin: 96W, 23N
labs(x = "", y = "") +
theme_void() +
theme(panel.background = element_rect(fill  = "#e9f5f8"),
panel.grid       = element_line(color = "#e9f5f8"),
legend.position = "none")
# export
ggsave(filename = "figure_3f.png", plot = figure_3f, device = "png",
height = 4.818, width = 5, path = "output/figures/components/")
figure_s5b <- figure_3b
# export
ggsave(filename = "figure_s5b.png", plot = figure_s5b, device = "png",
height = 4.818, width = 5, path = "output/figures/components/")
# attaches packages ........................................................
source("code/0-setup/01-setup.R")
wildfires_all <- readRDS("data/interim/wildfires_all.rds")
summary(as.numeric(wildfires_all$wildfire_area_m2))
summary(as.numeric(wildfires_all$wildfire_area_m2/1000000))
sd(as.numeric(wildfires_all$wildfire_area_m2/1000000))
# attaches packages ........................................................
source("code/0-setup/01-setup.R")
# attaches packages ........................................................
source("code/0-setup/01-setup.R")
knitr::opts_chunk$set(echo=FALSE)
source("../../code/0-setup/01-setup.R")
wells_all <- readRDS("data/interim/wells_all.rds")
glimpse(wells_all)
us_states_included <- st_read("data/raw/esri/USA_States_Generalized.shp") %>%
filter(STATE_ABBR %in%
c("OR", "CA", "NV", "AZ", "MT", "WY", "UT", "CO", "NM",
"ND", "SD", "NE", "KS", "OK", "TX", "MO", "AR", "LA")) %>%
st_geometry() %>%
st_transform(crs_albers)
wells_all[c(1:5), ]
d <- wells_all[c(1:5), ] %>% st_intersects(us_states_included)
glimpse(wells_all)
wells_all_sf <- wells_all %>% st_as_sf()
wells_all_sf
wells_all_sf <- wells_all %>% st_as_sf() %>% st_tranform(crs_albers)
wells_all_sf <- wells_all %>% st_as_sf() %>% st_transform(crs_albers)
wells_all_sf
d <- wells_all[c(1:5), ] %>% st_intersects(us_states_included)
d <- wells_all_sf[c(1:5), ] %>% st_intersects(us_states_included)
d
us_states_included
d <- wells_all_sf[c(1:500), ] %>% st_intersects(us_states_included)
d
d <- wells_all_sf[c(1:500), ] %>% st_intersection(us_states_included)
d
glimpse(d)
wells_coastal %>% wells_all %>% filter(state == "CA")
wells_coastal <- wells_all %>% filter(state == "CA")
c <- wells_coastal
glimpse(c)
c <- wells_all_sf %>% filter(state == "CA")
rm(wells_coastal)
rm(d)
d <- c %>% st_intersection(us_states_included)
l <- wells_all_sf %>% filter(state == "LA")
t <- wells_all_sf %>% filter(state == "TX")
t2 <- t %>% st_intersection(us_states_included)
t3 <- t %>% filter(api_number %!in% t2)
t3 <- t %>% filter(api_number %!in% t2$api_number)
t3
glimpse(t3)
plot(t3)
plot(st_geometry(t3))
View(t3)
c2 <- d
rm(d)
c3 <- c %>% filter(api_number %!in% c2$api_number)
c3
glimpse(c3)
rm(c, c2, c3)
rm(l, t, t2, t3)
wells_states_intersection <- wells_all_sf %>% st_intersection(us_states_included)
nrow(wells_all) - nrow(wells_states_intersection)
# attaches necessary packages
source("code/0-setup/01-setup.R")
library("lubridate")
# data input
wells_individual_wildfires <-
read_csv("data/processed/wells_individual_wildfires.csv")
# figure s1 ................................................................
# total area burned by year
figure_s1 <- wells_individual_wildfires %>%
filter(state %!in% c("ID", "WA")) %>%
filter(year %in% c(1984:2019)) %>%
mutate(wildfire_area_ha = (as.numeric(wildfire_area_m2) / 10000)) %>%
group_by(year, state) %>%
mutate(year = as.numeric(year)) %>%
summarize(area_burned_ha = sum(wildfire_area_ha)) %>%
ggplot(aes(year, area_burned_ha)) +
geom_smooth(method = "lm", formula = y ~ x,  se = FALSE,
color = "black", lwd = 0.3, linetype = "longdash", alpha = 0.3) +
geom_point(size = 0.6) +
labs(x = "Year", y = "Wildfire burn area (ha)") +
theme_classic() +
theme(legend.position = "none") +
facet_wrap(~ state)
figure_s1
# figure s1 ................................................................
# total area burned by year
figure_s1 <- wells_individual_wildfires %>%
filter(state %!in% c("ID", "WA")) %>%
filter(year %in% c(1984:2019)) %>%
mutate(wildfire_area_ha = (as.numeric(wildfire_area_m2) / 10000)) %>%
group_by(year, state) %>%
mutate(year = as.numeric(year)) %>%
summarize(area_burned_ha = sum(wildfire_area_ha)) %>%
ggplot(aes(year, area_burned_ha)) +
geom_smooth(method = "lm", formula = y ~ x,  se = FALSE,
color = "black", lwd = 0.3, linetype = "longdash", alpha = 0.3) +
geom_point(size = 0.6) +
labs(x = "Year", y = "Wildfire burn area (ha)") +
theme_classic() +
theme(legend.position = "none") +
facet_wrap(~ state, scales = "free_y")
figure_s1
# exports figures
ggsave(filename = "figure_s1.png", plot = figure_s1, device = "png",
height = 5.6, width = 8.2, path = "output/figures/components/")
# attaches necessary packages
source("code/0-setup/01-setup.R")
library("lubridate")
# data input
wells_wildfire_state_year <-
read_csv("data/processed/wells_wildfire_state_year.csv")
# attaches necessary packages
source("code/0-setup/01-setup.R")
library("lubridate")
# data input
wells_wildfire_state_year <-
read_csv("data/processed/wells_wildfire_state_year.csv")
# figure s1 ................................................................
# total area burned by year
figure_s1 <- wells_wildfire_state_year %>%
filter(state %!in% c("ID", "WA")) %>%
filter(year %in% c(1984:2019)) %>%
group_by(year, state) %>%
mutate(year = as.numeric(year)) %>%
summarize(n_wells = sum(n_wells)) %>%
ggplot(aes(year, n_wells)) +
geom_smooth(method = "lm", formula = y ~ x, se = FALSE,
color = "black", lwd = 0.3, linetype = "longdash", alpha = 0.3) +
geom_point(size = 0.6) +
labs(x = "Year", y = "Wells (n)") +
theme_classic() +
theme(legend.position = "none") +
facet_wrap(~ state)
# figure s1 ................................................................
# total area burned by year
figure_s1 <- wells_wildfire_state_year %>%
filter(state %!in% c("ID", "WA")) %>%
filter(year %in% c(1984:2019)) %>%
group_by(year, state) %>%
mutate(year = as.numeric(year)) %>%
summarize(n_wells = sum(n_wells)) %>%
ggplot(aes(year, n_wells)) +
geom_smooth(method = "lm", formula = y ~ x, se = FALSE,
color = "black", lwd = 0.3, linetype = "longdash", alpha = 0.3) +
geom_point(size = 0.6) +
labs(x = "Year", y = "Wells (n)") +
theme_classic() +
theme(legend.position = "none") +
facet_wrap(~ state, scales = "free_y")
# exports figures
ggsave(filename = "figure_s1.png", plot = figure_s1, device = "png",
height = 5.6, width = 8.2, path = "output/figures/components/")
wells_wildfire_state_year %>%
filter(state %!in% c("ID", "WA")) %>%
filter(year %in% c(1984:2019)) %>%
group_by(year, state)
# data input
pop_exposed_state_year <-
read_csv("data/processed/pop_exposed_state_year.csv")
# data input
pop_exposed_state_year <-
read_csv("data/processed/pop_exposed_state_year.csv")
# figure s3 ................................................................
# total area burned by year
figure_s3 <- pop_exposed_state_year %>%
filter(state %!in% c("ID", "WA")) %>%
filter(year %in% c(1984:2019)) %>%
group_by(year, state) %>%
mutate(year = as.numeric(year)) %>%
summarize(pop_exposed_n = sum(pop_exposed_n)) %>%
ggplot(aes(year, pop_exposed_n)) +
geom_smooth(method = "lm", formula = y ~ x, se = FALSE,
color = "black", lwd = 0.3, linetype = "longdash", alpha = 0.3) +
geom_point(size = 0.6) +
labs(x = "Year", y = "Wells (n)") +
theme_classic() +
theme(legend.position = "none") +
facet_wrap(~ state, scales = "free_y")
figure_s3
# exports figures
ggsave(filename = "figure_s3.png", plot = figure_s3, device = "png",
height = 5.6, width = 8.2, path = "output/figures/components/")
# figure s3 ................................................................
# total area burned by year
figure_s3 <- pop_exposed_state_year %>%
filter(state %!in% c("ID", "WA")) %>%
filter(year %in% c(1984:2019)) %>%
group_by(year, state) %>%
mutate(year = as.numeric(year)) %>%
summarize(pop_exposed_n = sum(pop_exposed_n)) %>%
ggplot(aes(year, pop_exposed_n)) +
geom_vline(aes(xintercept = 1990), lwd = 0.2, color = "gray") +
geom_vline(aes(xintercept = 2000), lwd = 0.2, color = "gray") +
geom_vline(aes(xintercept = 2010), lwd = 0.2, color = "gray") +
geom_smooth(method = "lm", formula = y ~ x, se = FALSE,
color = "black", lwd = 0.3, linetype = "longdash", alpha = 0.3) +
geom_point(size = 0.6) +
labs(x = "Year", y = "Wells (n)") +
theme_classic() +
theme(legend.position = "none") +
facet_wrap(~ state, scales = "free_y")
# exports figures
ggsave(filename = "figure_s3.png", plot = figure_s3, device = "png",
height = 5.6, width = 8.2, path = "output/figures/components/")
# figure s1 ................................................................
# total area burned by year
figure_s1 <- wells_wildfire_state_year %>%
filter(state %!in% c("ID", "WA")) %>%
filter(year %in% c(1984:2019)) %>%
group_by(year, state) %>%
mutate(year = as.numeric(year)) %>%
summarize(n_wells = sum(n_wells)) %>%
ggplot(aes(year, n_wells)) +
geom_vline(aes(xintercept = 1990), lwd = 0.2, color = "gray") +
geom_vline(aes(xintercept = 2000), lwd = 0.2, color = "gray") +
geom_vline(aes(xintercept = 2010), lwd = 0.2, color = "gray") +
geom_smooth(method = "lm", formula = y ~ x, se = FALSE,
color = "black", lwd = 0.3, linetype = "longdash", alpha = 0.3) +
geom_point(size = 0.6) +
labs(x = "Year", y = "Wells (n)") +
theme_classic() +
theme(legend.position = "none") +
facet_wrap(~ state, scales = "free_y")
# exports figures
ggsave(filename = "figure_s1.png", plot = figure_s1, device = "png",
height = 5.6, width = 8.2, path = "output/figures/components/")
# attaches necessary packages
source("code/0-setup/01-setup.R")
wells_all <- readRDS("data/interim/wells_all.rds")
d <- wells_all %>% group_by(state) %>% summarize(n = n())
View(d)
d <- wells_all %>% as_tibble() %>% group_by(state) %>% summarize(n = n())
summary(wells_all$date_latest)
182719/nrow(wells_all)
nrow(wells_all)-182719
(nrow(wells_all)-182719)/nrow(wells_all)
1488980
1488980+182719
d %>% write_csv("d.csv")
rm(d)
c <- wells_all %>% filter(state=="CA")
federal_lands <-
st_read("data/raw/stanford_geo/federal_lands/fedlanp020.shp") %>%
filter(STATE %in% c("OR", "CA", "NV", "AZ", "MT", "WY", "UT", "CO", "NM",
"ND", "SD", "NE", "KS", "OK", "TX", "MO", "AR", "LA")) %>%
st_transform(crs_albers) %>%
as_tibble() %>%
mutate(well_on_federal_land = 1) %>%
st_as_sf()
federal_lands <-
st_read("data/raw/stanford_geo/federal_lands/fedlanp020.shp") %>%
filter(STATE %in% c("OR", "CA", "NV", "AZ", "MT", "WY", "UT", "CO", "NM",
"ND", "SD", "NE", "KS", "OK", "TX", "MO", "AR", "LA")) %>%
st_transform(crs_albers) %>%
as_tibble() %>%
mutate(well_on_federal_land = 1) %>%
st_as_sf() %>% st_union()
fed_land_ca <-
st_read("data/raw/stanford_geo/federal_lands/fedlanp020.shp") %>%
filter(STATE =="CA") %>%
st_transform(crs_albers) %>%
as_tibble() %>%
mutate(well_on_federal_land = 1) %>%
st_as_sf() %>% st_union()
rm(federal_lands)
plot(fed_land_ca)
federal_lands <-
st_read("data/raw/stanford_geo/federal_lands/fedlanp020.shp") %>%
filter(STATE %in% c("OR", "CA", "NV", "AZ", "MT", "WY", "UT", "CO", "NM",
"ND", "SD", "NE", "KS", "OK", "TX", "MO", "AR", "LA")) %>%
st_transform(crs_albers) %>%
as_tibble() %>%
mutate(well_on_federal_land = 1) %>%
st_as_sf()
us_states_included <- st_read("data/raw/esri/USA_States_Generalized.shp") %>%
filter(STATE_ABBR %in%
c("OR", "CA", "NV", "AZ", "MT", "WY", "UT", "CO", "NM",
"ND", "SD", "NE", "KS", "OK", "TX", "MO", "AR", "LA")) %>%
st_geometry() %>%
st_transform(crs_albers)
federal_lands %>% filter(STATE == "CA") %>% View
fed_land_ca2 <- fed_land_ca %>% st_intersection(us_states_included)
=plot(fed_land_ca2)
plot(fed_land_ca2)
c
c_fed <- c %>% st_intersection(fed_land_ca2)
## setup ---------------------------------------------------------------------
source("code/0-setup/01-setup.R")
# data input
wells_kbdi <- readRDS("data/processed/wells_kbdi.rds")
federal_lands <-
st_read("data/raw/stanford_geo/federal_lands/fedlanp020.shp") %>%
filter(STATE %in% c("OR", "CA", "NV", "AZ", "MT", "WY", "UT", "CO", "NM",
"ND", "SD", "NE", "KS", "OK", "TX", "MO", "AR", "LA")) %>%
st_transform(crs_albers) %>%
as_tibble() %>%
mutate(well_on_federal_land = 1) %>%
st_as_sf()
us_states_included <- st_read("data/raw/esri/USA_States_Generalized.shp") %>%
filter(STATE_ABBR %in%
c("OR", "CA", "NV", "AZ", "MT", "WY", "UT", "CO", "NM",
"ND", "SD", "NE", "KS", "OK", "TX", "MO", "AR", "LA")) %>%
st_geometry() %>%
st_transform(crs_albers) %>%
st_union()
# makes dataset with well ID and geometry only
wells <- wells_kbdi %>%
select(api_number, state, geometry) %>%
st_as_sf() %>%
st_transform(crs_albers)
federal_lands <-
st_read("data/raw/stanford_geo/federal_lands/fedlanp020.shp") %>%
filter(STATE %in% c("OR", "CA", "NV", "AZ", "MT", "WY", "UT", "CO", "NM",
"ND", "SD", "NE", "KS", "OK", "TX", "MO", "AR", "LA")) %>%
st_transform(crs_albers) %>%
as_tibble() %>%
mutate(well_on_federal_land = 1) %>%
st_as_sf() %>%
st_intersection(us_states_included)
# CA .......................................................................
fedlands_ca <- federal_lands %>% filter(STATE == "CA") %>%
st_geometry() %>%
st_union()
wells_ca <- wells %>% filter(state == "CA")
wells_fedlands_ca <- st_intersection(wells_ca, fedlands_ca)
saveRDS(wells_fedlands_ca,
"data/interim/wells_on_public_lands/wells_fedlands_ca.rds")
saveRDS(wells_fedlands_ca,
"data/interim/wells_on_public_land/wells_fedlands_ca.rds")
saveRDS(wells_fedlands_ca,
"data/interim/wells_on_public_land/wells_fedlands_ca.rds")
View(wells_fedlands_ca)
wells_kbdi_ca <- wells_kbdi %>%
left_join(wells_fedlands_ca, by = c("api_number", "state")) %>%
mutate(well_on_federal_land = replace_na(well_on_federal_land, 0))
# attaches necessary packages
source("code/0-setup/01-setup.R")
library("lubridate")
# data input
pop_exposed_state_year <-
read_csv("data/processed/pop_exposed_state_year.csv")
d <- pop_exposed_state_year %>% group_by(state) %>% summarize(pop_exposed = sum(pop_exposed_n))
View(d)
d
wells_kbdi_ca2 <- wells_kbdi_ca %>% filter(state == "CA")
c <- wells_kbdi_ca2
c %>% filter(well_on_federal_land == 1) %>% View()
c %>% filter(well_on_federal_land == 1) %>% filter(kbdi_max_2017 >= 600)
c %>% filter(well_on_federal_land == 1) %>% filter(kbdi_max_2017 >= 600) %>% nrow()
View(wells_fedlands_ca)
