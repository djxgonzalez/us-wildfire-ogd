st_as_sf(coords = c("x", "y"), crs = crs_nad83) %>%
st_transform(crs_albers) %>%
st_intersection(us_states_west)
kbdi_high_2090_sf <- readRDS("data/processed/kbdi_max_2090.rds") %>%
as_tibble() %>%
mutate(kbdi_over_450 = case_when(kbdi_max_2090 >= 450 ~ 1,
kbdi_max_2090 <  450 ~ 0),
kbdi_over_600 = case_when(kbdi_max_2090 >= 600 ~ 1,
kbdi_max_2090 <  600 ~ 0)) %>%
st_as_sf(coords = c("x", "y"), crs = crs_nad83) %>%
st_transform(crs_albers) %>%
st_intersection(us_states_west)
# preps layers
kbdi_450_2017 <-
kbdi_high_2017_sf %>% filter(kbdi_over_450 == 1) %>% st_geometry()
kbdi_450_2050 <-
kbdi_high_2050_sf %>% filter(kbdi_over_450 == 1) %>% st_geometry()
kbdi_450_2090 <-
kbdi_high_2090_sf %>% filter(kbdi_over_450 == 1) %>% st_geometry()
kbdi_600_2017 <-
kbdi_high_2017_sf %>% filter(kbdi_over_600 == 1) %>% st_geometry()
kbdi_600_2050 <-
kbdi_high_2050_sf %>% filter(kbdi_over_600 == 1) %>% st_geometry()
kbdi_600_2090 <-
kbdi_high_2090_sf %>% filter(kbdi_over_600 == 1) %>% st_geometry()
# removes data no longer needed
rm(kbdi_high_2017_sf, kbdi_high_2050_sf, kbdi_high_2090_sf)
## generates figure ----------------------------------------------------------
# figure 4a ................................................................
figure_4a <- ggplot() +
geom_sf(data = mex_can,   color = NA, fill = "#D4D4D4") +
geom_sf(data = us_states, color = NA, fill = "#E5E5E5", alpha = 0.7) +
geom_sf(data = kbdi_450_2017, shape = 15, color = "#AD8ABB", size = 0.0001) +
geom_sf(data = us_states_east, color = NA, fill = "#D4D4D4") +
geom_sf(data = us_states,   color = "white", fill = NA, lwd = 0.2) +
geom_sf(data = us_boundary, color = "white", fill = NA, lwd = 0.3) +
# geom_sf(data = wells_all_buffer_1km, fill = "black", color = NA, alpha = 0.6) +
xlim(-2300000, 560000) + ylim(340000, 3100000) +  # origin: 96W, 23N
labs(x = "", y = "") +
theme_void() +
theme(panel.background = element_rect(fill  = "#e9f5f8"),
panel.grid       = element_line(color = "#e9f5f8"),
legend.position = "none")
# export
ggsave(filename = "figure_4a.png", plot = figure_4a, device = "png",
height = 4.818, width = 5, path = "output/figures/components/")
# figure 4b ................................................................
figure_4b <- ggplot() +
geom_sf(data = mex_can,   color = NA, fill = "#D4D4D4") +
geom_sf(data = us_states, color = NA, fill = "#E5E5E5", alpha = 0.7) +
geom_sf(data = kbdi_450_2050, shape = 15, color = "#AD8ABB", size = 0.4) +
geom_sf(data = us_states_east, color = NA, fill = "#D4D4D4") +
geom_sf(data = us_states,   color = "white", fill = NA, lwd = 0.2) +
geom_sf(data = us_boundary, color = "white", fill = NA, lwd = 0.3) +
geom_sf(data = wells_all_buffer_1km, fill = "black", color = NA, alpha = 0.6) +
xlim(-2300000, 560000) + ylim(340000, 3100000) +  # origin: 96W, 23N
labs(x = "", y = "") +
theme_void() +
theme(panel.background = element_rect(fill  = "#e9f5f8"),
panel.grid       = element_line(color = "#e9f5f8"),
legend.position = "none")
# export
ggsave(filename = "figure_4b.png", plot = figure_4b, device = "png",
height = 4.818, width = 5, path = "output/figures/components/")
# figure 4c ................................................................
figure_4c <- ggplot() +
geom_sf(data = mex_can,   color = NA, fill = "#D4D4D4") +
geom_sf(data = us_states, color = NA, fill = "#E5E5E5", alpha = 0.7) +
geom_sf(data = kbdi_450_2090, shape = 15, color = "#AD8ABB", size = 0.4) +
geom_sf(data = us_states_east, color = NA, fill = "#D4D4D4") +
geom_sf(data = us_states,   color = "white", fill = NA, lwd = 0.2) +
geom_sf(data = us_boundary, color = "white", fill = NA, lwd = 0.3) +
geom_sf(data = wells_all_buffer_1km, fill = "black", color = NA, alpha = 0.6) +
xlim(-2300000, 560000) + ylim(340000, 3100000) +  # origin: 96W, 23N
labs(x = "", y = "") +
theme_void() +
theme(panel.background = element_rect(fill  = "#e9f5f8"),
panel.grid       = element_line(color = "#e9f5f8"),
legend.position = "none")
# export
ggsave(filename = "figure_4c.png", plot = figure_4c, device = "png",
height = 4.818, width = 5, path = "output/figures/components/")
# figure 4d ................................................................
figure_4d <- ggplot() +
geom_sf(data = mex_can,   color = NA, fill = "#D4D4D4") +
geom_sf(data = us_states, color = NA, fill = "#E5E5E5", alpha = 0.7) +
geom_sf(data = kbdi_600_2017, shape = 15, color = "#F0A3D0", size = 0.0001) +
geom_sf(data = us_states_east, color = NA, fill = "#D4D4D4") +
geom_sf(data = us_states,   color = "white", fill = NA, lwd = 0.2) +
geom_sf(data = us_boundary, color = "white", fill = NA, lwd = 0.3) +
geom_sf(data = wells_all_buffer_1km, fill = "black", color = NA, alpha = 0.6) +
xlim(-2300000, 560000) + ylim(340000, 3100000) +  # origin: 96W, 23N
labs(x = "", y = "") +
theme_void() +
theme(panel.background = element_rect(fill  = "#e9f5f8"),
panel.grid       = element_line(color = "#e9f5f8"),
legend.position = "none")
# export
ggsave(filename = "figure_4d.png", plot = figure_4d, device = "png",
height = 4.818, width = 5, path = "output/figures/components/")
# figure 4e ................................................................
figure_4e <- ggplot() +
geom_sf(data = mex_can,   color = NA, fill = "#D4D4D4") +
geom_sf(data = us_states, color = NA, fill = "#E5E5E5", alpha = 0.7) +
geom_sf(data = kbdi_600_2050, shape = 15, color = "#F0A3D0", size = 0.4) +
geom_sf(data = us_states_east, color = NA, fill = "#D4D4D4") +
geom_sf(data = us_states,   color = "white", fill = NA, lwd = 0.2) +
geom_sf(data = us_boundary, color = "white", fill = NA, lwd = 0.3) +
geom_sf(data = wells_all_buffer_1km, fill = "black", color = NA, alpha = 0.6) +
xlim(-2300000, 560000) + ylim(340000, 3100000) +  # origin: 96W, 23N
labs(x = "", y = "") +
theme_void() +
theme(panel.background = element_rect(fill  = "#e9f5f8"),
panel.grid       = element_line(color = "#e9f5f8"),
legend.position = "none")
# export
ggsave(filename = "figure_4e.png", plot = figure_4e, device = "png",
height = 4.818, width = 5, path = "output/figures/components/")
# figure 4f ................................................................
figure_4f <- ggplot() +
geom_sf(data = mex_can,   color = NA, fill = "#D4D4D4") +
geom_sf(data = us_states, color = NA, fill = "#E5E5E5", alpha = 0.7) +
geom_sf(data = kbdi_600_2090, shape = 15, color = "#F0A3D0", size = 0.4) +
geom_sf(data = us_states_east, color = NA, fill = "#D4D4D4") +
geom_sf(data = us_states,   color = "white", fill = NA, lwd = 0.2) +
geom_sf(data = us_boundary, color = "white", fill = NA, lwd = 0.3) +
geom_sf(data = wells_all_buffer_1km, fill = "black", color = NA, alpha = 0.6) +
xlim(-2300000, 560000) + ylim(340000, 3100000) +  # origin: 96W, 23N
labs(x = "", y = "") +
theme_void() +
theme(panel.background = element_rect(fill  = "#e9f5f8"),
panel.grid       = element_line(color = "#e9f5f8"),
legend.position = "none")
# export
ggsave(filename = "figure_4f.png", plot = figure_4f, device = "png",
height = 4.818, width = 5, path = "output/figures/components/")
##============================================================================##
# figure 4a ................................................................
figure_4a <- ggplot() +
geom_sf(data = mex_can,   color = NA, fill = "#D4D4D4") +
geom_sf(data = us_states, color = NA, fill = "#E5E5E5", alpha = 0.7) +
geom_sf(data = kbdi_450_2017, shape = 15, color = "#AD8ABB", size = 0.0001) +
geom_sf(data = us_states_east, color = NA, fill = "#D4D4D4") +
geom_sf(data = us_states,   color = "white", fill = NA, lwd = 0.2) +
geom_sf(data = us_boundary, color = "white", fill = NA, lwd = 0.3) +
geom_sf(data = wells_all_buffer_1km, fill = "black", color = NA, alpha = 0.6) +
xlim(-2300000, 560000) + ylim(340000, 3100000) +  # origin: 96W, 23N
labs(x = "", y = "") +
theme_void() +
theme(panel.background = element_rect(fill  = "#e9f5f8"),
panel.grid       = element_line(color = "#e9f5f8"),
legend.position = "none")
# export
ggsave(filename = "figure_4a.png", plot = figure_4a, device = "png",
height = 4.818, width = 5, path = "output/figures/components/")
# attaches necessary packages
source("code/0-setup/01-setup.R")
library("ggspatial")
library("lubridate")
library("units")
# data input
wells_all <- readRDS("data/processed/wells_all.rds")
wildfires_wells_population <-
readRDS("data/processed/wildfires_wells_population.rds")
# figure 1c ................................................................
# count of oil and gas wells in wildfire burn areas by year
figure_1c <- wells_all %>%
drop_na(date_earliest)
# figure 1c ................................................................
# count of oil and gas wells in wildfire burn areas by year
figure_1c <- wells_all %>%
drop_na(date_earliest) %>%
mutate(year = year(date_earliest)) #%>%
figure_1c
glimpse(figure_1c)
# figure 1c ................................................................
# count of oil and gas wells in wildfire burn areas by year
figure_1c <- wells_all %>%
drop_na(date_earliest) %>%
mutate(year = as.factor(year(date_earliest))) #%>%
glimpse(figure_1c)
# figure 1c ................................................................
# count of oil and gas wells in wildfire burn areas by year
figure_1c <- wells_all %>%
drop_na(date_earliest) %>%
select(date_earliest) %>%
mutate(year = as.factor(year(date_earliest))) #%>%
# figure 1c ................................................................
# count of oil and gas wells in wildfire burn areas by year
figure_1c <- wells_all %>%
as_tibble() %>%
drop_na(date_earliest) %>%
select(date_earliest) %>%
mutate(year = as.factor(year(date_earliest))) #%>%
figure_1c
# figure 1c ................................................................
# count of oil and gas wells in wildfire burn areas by year
figure_1c <- wells_all %>%
as_tibble() %>%
drop_na(date_earliest) %>%
select(date_earliest) %>%
mutate(year = as.factor(year(date_earliest))) %>%
group_by(year) %>%
summarize(n_wells = n()) #%>%
figure_1c
glimpse(figure_1c)
# figure 1c ................................................................
# count of oil and gas wells in wildfire burn areas by year
figure_1c <- wells_all %>%
as_tibble() %>%
drop_na(date_earliest) %>%
select(date_earliest) %>%
mutate(year = as.factor(year(date_earliest))) %>%
group_by(year) %>%
summarize(n_wells = n()) %>%
ggplot()  +
geom_bar(aes(year, n_wells), stat = "identity") +
labs(x = "", y = "") +
theme_classic() +
theme(axis.line.x  = element_blank(),  # removes x-axis
axis.ticks.x = element_blank(),
axis.text.x  = element_blank(),
axis.text.y  = element_blank(),
legend.position = "none")
figure_1c
# figure 1c ................................................................
# count of oil and gas wells in wildfire burn areas by year
data_1c <- wells_all %>%
as_tibble() %>%
drop_na(date_earliest) %>%
select(date_earliest) %>%
mutate(year = as.factor(year(date_earliest))) %>%
group_by(year) %>%
summarize(n_wells = n())
data_1c
# figure 1c ................................................................
# count of oil and gas wells in wildfire burn areas by year
data_1c <- wells_all %>%
as_tibble() %>%
drop_na(date_earliest) %>%
select(date_earliest) %>%
mutate(year = year(date_earliest)) %>%
group_by(year) %>%
summarize(n_wells = n())
# figure 1c ................................................................
# count of oil and gas wells in wildfire burn areas by year
data_1c <- wells_all %>%
as_tibble() %>%
drop_na(date_earliest) %>%
select(date_earliest) %>%
mutate(year = year(date_earliest)) %>%
group_by(year) %>%
summarize(n_wells = n())
n_wells_pre1984 <- data_1c %>% filter(year < 1984)
n_wells_pre1984
wells_pre1984 <- data_1c %>% filter(year < 1984) %>% select()
wells_pre1984 <- data_1c %>% filter(year < 1984)
n_wells_pre1984 <- sum(wells_pre1984$n_wells)
# figure 1c ................................................................
# count of oil and gas wells in wildfire burn areas by year
wells_years <- wells_all %>%
as_tibble() %>%
drop_na(date_earliest) %>%
select(date_earliest) %>%
mutate(year = year(date_earliest)) %>%
group_by(year) %>%
summarize(n_wells = n())
wells_pre1984 <- wells_years %>% filter(year < 1984)
n_wells_pre1984 <- sum(wells_pre1984$n_wells)
data_1c <- wells_years %>%
filter(year >= 1984) %>%
mutate(n_wells = n_wells + n_wells_pre1984) %>%
mutate(year = as.factor(year))
data_1c
?cumsum
# preps data
wells_years <- wells_all %>%
as_tibble() %>%
drop_na(date_earliest) %>%
select(date_earliest) %>%
mutate(year = year(date_earliest)) %>%
group_by(year) %>%
summarize(n_wells = n()) %>%
mutate(n_wells_cumulative = cumsum(n_wells))
glimpse(wells_years)
View(wells_years)
filter(year >= 1984) %>%
mutate(year = as.factor(year))
# preps data
wells_years <- wells_all %>%
as_tibble() %>%
drop_na(date_earliest) %>%
select(date_earliest) %>%
mutate(year = year(date_earliest)) %>%
group_by(year) %>%
summarize(n_wells = n()) %>%
mutate(n_wells_cumulative = cumsum(n_wells)) %>%
filter(year >= 1984) %>%
mutate(year = as.factor(year))
wells_years
# preps data
wells_years <- wells_all %>%
as_tibble() %>%
mutate(date_earliest = replace_na(1900)) %>%
select(date_earliest) %>%
mutate(year = year(date_earliest)) %>%
group_by(year) %>%
summarize(n_wells = n()) %>%
mutate(n_wells_cumulative = cumsum(n_wells)) %>%
filter(year >= 1984) %>%
mutate(year = as.factor(year))
# preps data
wells_years <- wells_all %>%
as_tibble() %>%
mutate(date_earliest = replace_na(date_earliest, 1900)) %>%
select(date_earliest) %>%
mutate(year = year(date_earliest)) %>%
group_by(year) %>%
summarize(n_wells = n()) %>%
mutate(n_wells_cumulative = cumsum(n_wells)) %>%
filter(year >= 1984) %>%
mutate(year = as.factor(year))
# preps data
wells_years <- wells_all %>%
as_tibble() %>%
mutate(date_earliest = replace_na(date_earliest, as.Date("1900-01-01"))) %>%
select(date_earliest) %>%
mutate(year = year(date_earliest)) %>%
group_by(year) %>%
summarize(n_wells = n()) %>%
mutate(n_wells_cumulative = cumsum(n_wells)) %>%
filter(year >= 1984) %>%
mutate(year = as.factor(year))
wells_years
View(wells_years)
# makes figure
figure_1c <- data_1c %>%
ggplot()  +
geom_bar(aes(year, n_wells), stat = "identity") +
labs(x = "", y = "") +
theme_classic() +
theme(axis.line.x  = element_blank(),  # removes x-axis
axis.ticks.x = element_blank(),
axis.text.x  = element_blank(),
axis.text.y  = element_blank(),
legend.position = "none")
figure_1c
# preps data
data_1c <- wells_all %>%
as_tibble() %>%
mutate(date_earliest = replace_na(date_earliest, as.Date("1900-01-01"))) %>%
select(date_earliest) %>%
mutate(year = year(date_earliest)) %>%
group_by(year) %>%
summarize(n_wells = n()) %>%
mutate(n_wells_cumulative = cumsum(n_wells)) %>%
filter(year >= 1984) %>%
mutate(year = as.factor(year))
# makes figure
figure_1c <- data_1c %>%
ggplot()  +
geom_bar(aes(year, n_wells), stat = "identity") +
labs(x = "", y = "") +
theme_classic() +
theme(axis.line.x  = element_blank(),  # removes x-axis
axis.ticks.x = element_blank(),
axis.text.x  = element_blank(),
axis.text.y  = element_blank(),
legend.position = "none")
figure_1c
View(figure_1c)
View(wells_all)
View(data_1c)
# makes figure
figure_1c <- data_1c %>%
ggplot()  +
geom_bar(aes(year, n_wells_cumulative), stat = "identity") +
labs(x = "", y = "") +
theme_classic() +
theme(axis.line.x  = element_blank(),  # removes x-axis
axis.ticks.x = element_blank(),
axis.text.x  = element_blank(),
axis.text.y  = element_blank(),
legend.position = "none")
figure_1c
# figure 1b ................................................................
# total area burned by year
figure_1b <- wildfires_wells_population %>%
mutate(year = as.factor(year),
wildfire_area_km2 = (as.numeric(wildfire_area_m2) / 1000000)) %>%
group_by(year) %>%
summarize(area_burned_km2 = sum(wildfire_area_km2)) %>%
ggplot() +
geom_bar(aes(year, area_burned_km2), stat = "identity") +
labs(x = "", y = "") +
theme_classic() +
theme(axis.text.y  = element_blank(),
legend.position = "none")
figure_1b
# figure 1b ................................................................
# total area burned by year
figure_1b <- wildfires_wells_population %>%
mutate(year = as.factor(year),
wildfire_area_km2 = (as.numeric(wildfire_area_m2) / 1000000)) %>%
group_by(year) %>%
summarize(area_burned_km2 = sum(wildfire_area_km2)) %>%
ggplot() +
geom_bar(aes(year, area_burned_km2), stat = "identity") +
labs(x = "", y = "") +
theme_classic() +
theme(axis.text.x  = element_blank(),axis.text.y  = element_blank(),
legend.position = "none")
figure_1b
# figure 1b ................................................................
# total area burned by year
figure_1b <- wildfires_wells_population %>%
mutate(year = as.factor(year),
wildfire_area_km2 = (as.numeric(wildfire_area_m2) / 1000000)) %>%
group_by(year) %>%
summarize(area_burned_km2 = sum(wildfire_area_km2)) %>%
ggplot() +
geom_bar(aes(year, area_burned_km2), stat = "identity") +
labs(x = "", y = "") +
theme_classic() +
theme(axis.line.x  = element_blank(),  # removes x-axis
axis.ticks.x = element_blank(),
axis.text.x  = element_blank(),axis.text.y  = element_blank(),
legend.position = "none")
figure_1b
# makes figure
figure_1c <- data_1c %>%
ggplot()  +
geom_bar(aes(year, n_wells_cumulative), stat = "identity") +
labs(x = "", y = "") +
theme_classic() +
theme(axis.text.x  = element_blank(),
axis.text.y  = element_blank(),
legend.position = "none")
figure_1c
# exports figures
ggsave(filename = "figure_1b.png", plot = figure_1b, device = "png",
height = 1.5, width = 6, path = "output/figures/components/")
# exports figures
ggsave(filename = "figure_1c.png", plot = figure_1c, device = "png",
height = 1.7, width = 6, path = "output/figures/components/")
# exports figures
ggsave(filename = "figure_1c.png", plot = figure_1c, device = "png",
height = 1.6, width = 6, path = "output/figures/components/")
6*10/6
1.6*10/6
1.5*10/6
# figure 1b ................................................................
# total area burned by year
figure_1b <- wildfires_wells_population %>%
mutate(year = as.factor(year),
wildfire_area_km2 = (as.numeric(wildfire_area_m2) / 1000000)) %>%
group_by(year) %>%
summarize(area_burned_km2 = sum(wildfire_area_km2)) %>%
ggplot() +
geom_bar(aes(year, area_burned_km2), stat = "identity") +
labs(x = "", y = "") +
theme_classic() +
theme(axis.line.x  = element_blank(),  # removes x-axis
axis.ticks.x = element_blank(),
axis.text.x  = element_blank(),axis.text.y  = element_blank(),
legend.position = "none")
# exports figures
ggsave(filename = "figure_1b.png", plot = figure_1b, device = "png",
height = 2.5, width = 10, path = "output/figures/components/")
# preps data
data_1c <- wells_all %>%
as_tibble() %>%
mutate(date_earliest = replace_na(date_earliest, as.Date("1900-01-01"))) %>%
select(date_earliest) %>%
mutate(year = year(date_earliest)) %>%
group_by(year) %>%
summarize(n_wells = n()) %>%
mutate(n_wells_cumulative = cumsum(n_wells)) %>%
filter(year >= 1984) %>%
mutate(year = as.factor(year))
# makes figure
figure_1c <- data_1c %>%
ggplot()  +
geom_bar(aes(year, n_wells_cumulative), stat = "identity") +
labs(x = "", y = "") +
theme_classic() +
theme(axis.text.x  = element_blank(),
axis.text.y  = element_blank(),
legend.position = "none")
# exports figures
ggsave(filename = "figure_1c.png", plot = figure_1c, device = "png",
height = 2.667, width = 10, path = "output/figures/components/")
# figure 1b ................................................................
# total area burned by year
figure_1b <- wildfires_wells_population %>%
mutate(year = as.factor(year),
wildfire_area_km2 = (as.numeric(wildfire_area_m2) / 1000000)) %>%
group_by(year) %>%
summarize(area_burned_km2 = sum(wildfire_area_km2))# %>%
View(figure_1b)
# figure 1b ................................................................
# total area burned by year
figure_1b <- wildfires_wells_population %>%
mutate(year = as.factor(year),
wildfire_area_km2 = (as.numeric(wildfire_area_m2) / 1000000)) %>%
group_by(year) %>%
summarize(area_burned_km2 = sum(wildfire_area_km2)) %>%
ggplot() +
geom_bar(aes(year, area_burned_km2), stat = "identity") +
labs(x = "", y = "") +
theme_classic() #+
figure_1b
