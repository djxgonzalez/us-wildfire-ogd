wildfires_ks_ok3 %>% mutate(eq2 = as.numeric(eq)) %>% filter(eq2 %in% c(1721, 1722)) %>% View
# coordinate reference system (CRS) for the project
# unprojected CRS, NAD83, for geographic data
# crs_nad83 <- st_crs("+init=epsg:4269 +proj=longlat +ellps=GRS80
#                         +datum=NAD83 +no_defs +towgs84=0,0,0")
crs_albers <- st_crs("+init=epsg:9822")
# attaches generally needed packages
library("sf")
# coordinate reference system (CRS) for the project
# unprojected CRS, NAD83, for geographic data
# crs_nad83 <- st_crs("+init=epsg:4269 +proj=longlat +ellps=GRS80
#                         +datum=NAD83 +no_defs +towgs84=0,0,0")
crs_albers <- st_crs("+init=epsg:9822")
# coordinate reference system (CRS) for the project
# unprojected CRS, NAD83, for geographic data
# crs_nad83 <- st_crs("+init=epsg:4269 +proj=longlat +ellps=GRS80
#                         +datum=NAD83 +no_defs +towgs84=0,0,0")
crs_albers <- st_crs(9822)
crs_albers
# coordinate reference system (CRS) for the project
# unprojected CRS, NAD83, for geographic data
# crs_nad83 <- st_crs("+init=epsg:4269 +proj=longlat +ellps=GRS80
#                         +datum=NAD83 +no_defs +towgs84=0,0,0")
crs_albers <- st_crs(5070)
crs_albers
# coordinate reference system (CRS) for the project
# unprojected CRS, NAD83, for geographic data
# crs_nad83 <- st_crs("+init=epsg:4269 +proj=longlat +ellps=GRS80
#                         +datum=NAD83 +no_defs +towgs84=0,0,0")
crs_nad83  <- st_crs(4269)
crs_nad83
crs_wgs84  <- st_crs(4326)
crs_wgs84
# uncomment as needed
# attaches generally needed packages
library("sf")
library("tidyverse")
library("RColorBrewer")
library("viridis")
# defines "not in" operator, the inverse of %in%
'%!in%' <- function(x,y)!('%in%'(x,y))
# coordinate reference system (CRS) for the project
crs_nad83  <- st_crs(4269)  # NAD83 coordinate reference system
crs_wgs84  <- st_crs(4326)  # WGS84 coordinate reference system
crs_albers <- st_crs(5070)  # Albers Equal-AreA Conic projection for N America
##============================================================================##
##---------------------------------------------------------------------------
## sets up environment
library("ggrepel")
library("ggspatial")
# data input, prep layers for mapping ......................................
us_states_west <- st_read("data/raw/us_census/tl_2018_us_state.shp") %>%
filter(STUSPS %in% c("WA", "OR", "CA", "ID", "NV", "AZ", "MT", "WY", "UT",
"CO", "NM", "ND", "SD", "NE", "KS", "OK", "TX", "MO",
"AR", "LA")) %>%
st_geometry() %>%
st_transform(crs_albers)
plot(us_states_west)
# loads necessary packages and defines global variables
source("../../code/0-setup/01-setup.R")
library("viridis")
wells_kbdi <- readRDS("../../data/processed/wells_kbdi.rds") %>%
st_transform(crs_albers)
# loads necessary packages and defines global variables
source("../../code/0-setup/01-setup.R")
library("viridis")
wells_kbdi <- readRDS("../../data/processed/wells_kbdi.rds")
study_region_sf <- readRDS("../../data/interim/study_region_sf.rds") %>%
st_transform(crs_albers)
kbdi_max_2017_sf <- readRDS("../../data/processed/kbdi_max_2017.rds") %>%
as_tibble() %>%
st_as_sf(coords = c("x", "y"), crs = crs_wgs84) %>%
st_transform(crs_albers) %>%
st_intersection(study_region_sf)
kbdi_max_2017_sf <- readRDS("../../data/processed/kbdi_max_2017.rds") %>%
as_tibble() %>%
st_as_sf(coords = c("x", "y"), crs = crs_wgs84) %>%
st_transform(crs_albers) %>%
st_intersection(study_region_sf)
kbdi_max_2017_sf <- readRDS("../../data/processed/kbdi_max_2017.rds") %>%
as_tibble() %>%
st_as_sf(coords = c("x", "y"), crs = crs_wgs84) #%>%
kbdi_max_2017_sf <- readRDS("../../data/processed/kbdi_max_2017.rds") %>%
as_tibble() %>%
st_as_sf(coords = c("x", "y"), crs = crs_wgs84) %>%
st_transform(crs_albers) #%>%
wildfires_all <- readRDS("data/processed/wildfires_all.rds")
class(wildfires_all)
# 1984
wildfires_all %>%
filter(state != "AK") %>%
filter(year == 1984) %>%
st_as_sf() %>%
st_transform(crs_albers) %>%
st_union() %>%
saveRDS("data/interim/buffers_wildfire_years/wildfires_union_contiguous_1984.rds")
plot(wildfires_all)
d <- wildfires_all %>%
filter(state != "AK") %>%
filter(year == 1984) %>%
st_as_sf() %>%
st_transform(crs_albers) %>%
st_union()
plot(d)
plot(us_states_west, add = T)
# loads necessary packages and defines global variables
source("../../code/0-setup/01-setup.R")
library("viridis")
wells_kbdi <- readRDS("../../data/processed/wells_kbdi.rds")
study_region_sf <- readRDS("../../data/interim/study_region_sf.rds") %>%
st_transform(crs_albers)
kbdi_max_2017_sf <- readRDS("../../data/processed/kbdi_max_2017.rds") %>%
as_tibble() %>%
st_as_sf(coords = c("x", "y"), crs = crs_wgs84) %>%
st_transform(crs_albers) %>%
st_intersection(study_region_sf)
wells_kbdi <- readRDS("../../data/processed/wells_kbdi.rds")
study_region_sf <- readRDS("../../data/interim/study_region_sf.rds") %>%
st_transform(crs_albers)
kbdi_max_2017_sf <- readRDS("../../data/processed/kbdi_max_2017.rds") %>%
as_tibble() %>%
st_as_sf(coords = c("x", "y"), crs = crs_wgs84) %>%
st_transform(crs_albers) %>%
st_intersection(study_region_sf)
# loads necessary packages and defines global variables
source("../../code/0-setup/01-setup.R")
library("viridis")
wells_kbdi <- readRDS("../../data/processed/wells_kbdi.rds")
study_region_sf <- readRDS("../../data/interim/study_region_sf.rds")
kbdi_max_2017_sf <- readRDS("../../data/processed/kbdi_max_2017.rds") %>%
as_tibble() %>%
st_as_sf(coords = c("x", "y"), crs = crs_wgs84) %>%
st_intersection(study_region_sf)
# loads necessary packages and defines global variables
source("../../code/0-setup/01-setup.R")
library("viridis")
wells_kbdi <- readRDS("../../data/processed/wells_kbdi.rds")
study_region_sf <- readRDS("../../data/interim/study_region_sf.rds")
kbdi_max_2017_sf <- readRDS("../../data/processed/kbdi_max_2017.rds") %>%
as_tibble() %>%
st_as_sf(coords = c("x", "y"), crs = crs_nad83) %>%
st_intersection(study_region_sf)
kbdi_max_2050_sf <- readRDS("../../data/processed/kbdi_max_2050.rds") %>%
as_tibble() %>%
st_as_sf(coords = c("x", "y"), crs = crs_nad83) %>%
st_intersection(study_region_sf)
kbdi_max_2090_sf <- readRDS("../../data/processed/kbdi_max_2090.rds") %>%
as_tibble() %>%
st_as_sf(coords = c("x", "y"), crs = crs_nad83) %>%
st_intersection(study_region_sf)
us_states_west <- st_read("../../data/raw/us_census/tl_2018_us_state.shp") %>%
filter(STUSPS %in% c("WA", "OR", "CA", "ID", "NV", "AZ", "MT", "WY",
"UT", "CO", "NM", "ND", "SD", "NE", "KS", "OK", "TX",
"MN", "IA", "MO", "AR", "LA")) %>%
st_geometry() %>%
st_transform(crs_nad83)
rm(study_region_sf)
ggplot() +
geom_sf(data = kbdi_max_2017_sf, aes(color = kbdi_max_2017)) +
scale_color_viridis(option = "B") +
geom_sf(data = us_states_west, color = "white", fill = NA) +
labs(color = "KBDI") +
theme_minimal()
wells_kbdi %>%
filter(kbdi_max_2017 >= 600) %>%
group_by(state) %>%
summarize(n = n()) %>%
ggplot() +
geom_bar(aes(state, n), stat = "identity") +
theme_classic()
wells_kbdi %>%
filter(kbdi_max_2017 >= 600) %>%
group_by(state) %>%
summarize(n = n()) %>%
arrange(desc(n))
wells_kbdi %>%
filter(kbdi_max_2017 >= 600) %>%
group_by(county_parish) %>%
summarize(n = n()) %>%
arrange(desc(n))
wells_kbdi %>%
filter(kbdi_max_2017 >= 600) %>%
group_by(operator) %>%
summarize(n = n()) %>%
arrange(desc(n))
ggplot() +
geom_sf(data = kbdi_max_2050_sf, aes(color = kbdi_max_2050)) +
scale_color_viridis(option = "B") +
geom_sf(data = us_states_west, color = "white", fill = NA) +
labs(color = "KBDI") +
theme_minimal()
wells_kbdi %>%
filter(kbdi_max_2050 >= 600) %>%
group_by(state) %>%
summarize(n = n()) %>%
ggplot() +
geom_bar(aes(state, n), stat = "identity") +
theme_classic()
wells_kbdi %>%
filter(kbdi_max_2050 >= 600) %>%
group_by(state) %>%
summarize(n = n()) %>%
arrange(desc(n))
wells_kbdi %>%
filter(kbdi_max_2050 >= 600) %>%
group_by(county_parish) %>%
summarize(n = n()) %>%
arrange(desc(n))
wells_kbdi %>%
filter(kbdi_max_2050 >= 600) %>%
group_by(operator) %>%
summarize(n = n()) %>%
arrange(desc(n))
ggplot() +
geom_sf(data = kbdi_max_2090_sf, aes(color = kbdi_max_2090)) +
scale_color_viridis(option = "B") +
geom_sf(data = us_states_west, color = "white", fill = NA) +
labs(color = "KBDI") +
theme_minimal()
wells_kbdi %>%
filter(kbdi_max_2090 >= 600) %>%
group_by(state) %>%
summarize(n = n()) %>%
ggplot() +
geom_bar(aes(state, n), stat = "identity") +
theme_classic()
wells_kbdi %>%
filter(kbdi_max_2090 >= 600) %>%
group_by(state) %>%
summarize(n = n()) %>%
arrange(desc(n))
wells_kbdi %>%
filter(kbdi_max_2090 >= 600) %>%
group_by(county_parish) %>%
summarize(n = n()) %>%
arrange(desc(n))
wells_kbdi %>%
filter(kbdi_max_2090 >= 600) %>%
group_by(operator) %>%
summarize(n = n()) %>%
arrange(desc(n))
ggplot() +
geom_sf(data = kbdi_max_2017_sf, aes(color = kbdi_max_2017)) +
scale_color_viridis(option = "B") +
geom_sf(data = us_states_west, color = "white", fill = NA) +
labs(color = "KBDI") +
theme_minimal()
wells_kbdi %>%
filter(kbdi_max_2017 >= 450) %>%
group_by(state) %>%
summarize(n = n()) %>%
ggplot() +
geom_bar(aes(state, n), stat = "identity") +
theme_classic()
wells_kbdi %>%
filter(kbdi_max_2017 >= 450) %>%
group_by(state) %>%
summarize(n = n()) %>%
arrange(desc(n))
wells_kbdi %>%
filter(kbdi_max_2017 >= 450) %>%
group_by(county_parish) %>%
summarize(n = n()) %>%
arrange(desc(n))
wells_kbdi %>%
filter(kbdi_max_2017 >= 450) %>%
group_by(operator) %>%
summarize(n = n()) %>%
arrange(desc(n))
ggplot() +
geom_sf(data = kbdi_max_2050_sf, aes(color = kbdi_max_2050)) +
scale_color_viridis(option = "B") +
geom_sf(data = us_states_west, color = "white", fill = NA) +
labs(color = "KBDI") +
theme_minimal()
wells_kbdi %>%
filter(kbdi_max_2050 >= 450) %>%
group_by(state) %>%
summarize(n = n()) %>%
ggplot() +
geom_bar(aes(state, n), stat = "identity") +
theme_classic()
wells_kbdi %>%
filter(kbdi_max_2050 >= 450) %>%
group_by(state) %>%
summarize(n = n()) %>%
arrange(desc(n))
wells_kbdi %>%
filter(kbdi_max_2050 >= 450) %>%
group_by(county_parish) %>%
summarize(n = n()) %>%
arrange(desc(n))
wells_kbdi %>%
filter(kbdi_max_2050 >= 450) %>%
group_by(operator) %>%
summarize(n = n()) %>%
arrange(desc(n))
ggplot() +
geom_sf(data = kbdi_max_2090_sf, aes(color = kbdi_max_2090)) +
scale_color_viridis(option = "B") +
geom_sf(data = us_states_west, color = "white", fill = NA) +
labs(color = "KBDI") +
theme_minimal()
wells_kbdi %>%
filter(kbdi_max_2090 >= 450) %>%
group_by(state) %>%
summarize(n = n()) %>%
ggplot() +
geom_bar(aes(state, n), stat = "identity") +
theme_classic()
wells_kbdi %>%
filter(kbdi_max_2090 >= 450) %>%
group_by(state) %>%
summarize(n = n()) %>%
arrange(desc(n))
wells_kbdi %>%
filter(kbdi_max_2090 >= 450) %>%
group_by(county_parish) %>%
summarize(n = n()) %>%
arrange(desc(n))
wells_kbdi %>%
filter(kbdi_max_2090 >= 450) %>%
group_by(operator) %>%
summarize(n = n()) %>%
arrange(desc(n))
ggplot() +
geom_sf(data = kbdi_max_2017_sf, aes(color = kbdi_max_2017)) +
scale_color_viridis(option = "B") +
geom_sf(data = us_states_west, color = "white", fill = NA) +
labs(color = "KBDI") +
theme_minimal()
wells_kbdi %>%
filter(kbdi_max_2017 >= 400) %>%
group_by(state) %>%
summarize(n = n()) %>%
ggplot() +
geom_bar(aes(state, n), stat = "identity") +
theme_classic()
wells_kbdi %>%
filter(kbdi_max_2017 >= 400) %>%
group_by(state) %>%
summarize(n = n()) %>%
arrange(desc(n))
wells_kbdi %>%
filter(kbdi_max_2017 >= 400) %>%
group_by(county_parish) %>%
summarize(n = n()) %>%
arrange(desc(n))
wells_kbdi %>%
filter(kbdi_max_2017 >= 400) %>%
group_by(operator) %>%
summarize(n = n()) %>%
arrange(desc(n))
ggplot() +
geom_sf(data = kbdi_max_2050_sf, aes(color = kbdi_max_2050)) +
scale_color_viridis(option = "B") +
geom_sf(data = us_states_west, color = "white", fill = NA) +
labs(color = "KBDI") +
theme_minimal()
wells_kbdi %>%
filter(kbdi_max_2050 >= 400) %>%
group_by(state) %>%
summarize(n = n()) %>%
ggplot() +
geom_bar(aes(state, n), stat = "identity") +
theme_classic()
wells_kbdi %>%
filter(kbdi_max_2050 >= 400) %>%
group_by(state) %>%
summarize(n = n()) %>%
arrange(desc(n))
wells_kbdi %>%
filter(kbdi_max_2050 >= 400) %>%
group_by(county_parish) %>%
summarize(n = n()) %>%
arrange(desc(n))
wells_kbdi %>%
filter(kbdi_max_2050 >= 400) %>%
group_by(operator) %>%
summarize(n = n()) %>%
arrange(desc(n))
ggplot() +
geom_sf(data = kbdi_max_2090_sf, aes(color = kbdi_max_2090)) +
scale_color_viridis(option = "B") +
geom_sf(data = us_states_west, color = "white", fill = NA) +
labs(color = "KBDI") +
theme_minimal()
wells_kbdi %>%
filter(kbdi_max_2090 >= 400) %>%
group_by(state) %>%
summarize(n = n()) %>%
ggplot() +
geom_bar(aes(state, n), stat = "identity") +
theme_classic()
wells_kbdi %>%
filter(kbdi_max_2090 >= 400) %>%
group_by(state) %>%
summarize(n = n()) %>%
arrange(desc(n))
wells_kbdi %>%
filter(kbdi_max_2090 >= 400) %>%
group_by(county_parish) %>%
summarize(n = n()) %>%
arrange(desc(n))
wells_kbdi %>%
filter(kbdi_max_2090 >= 400) %>%
group_by(operator) %>%
summarize(n = n()) %>%
arrange(desc(n))
# attaches packages ........................................................
source("code/0-setup/01-setup.R")
library("lubridate")
##### add more states, finalize
# processing and export ....................................................
wells_ak_buffer_1km <- wells_all #%>%
# data input
wells_all <- readRDS("data/processed/wells_all.rds")
##### add more states, finalize
# processing and export ....................................................
wells_ak_buffer_1km <- wells_all %>%
filter(state == "AK") #%>%
plot(st_geometry(wells_ak_buffer_1km))
##### add more states, finalize
# processing and export ....................................................
wells_ak_buffer_1km <- wells_all %>%
filter(state == "AK") %>%
st_transform(crs_albers) #%>%
plot(st_geometry(wells_ak_buffer_1km))
crs_albers
##### add more states, finalize
# processing and export ....................................................
# wells_ak_buffer_1km <- wells_all %>%
#   filter(state == "AK") %>%
#   st_transform(crs_albers) #%>%  ###### note: we need to find proj for AK
#   st_buffer(dist = 0.00898) %>%  # 0.00898 decimal degrees = 1,000 m
#   st_union()
# saveRDS(wells_ak_buffer_1km,
#         "data/interim/buffers_wells/buffers_ak_buffer_1km.rds")
wells_az_buffer_1km <- wells_all %>%
filter(state == "AZ") #%>%
##### add more states, finalize
# processing and export ....................................................
# wells_ak_buffer_1km <- wells_all %>%
#   filter(state == "AK") %>%
#   st_transform(crs_albers) #%>%  ###### note: we need to find proj for AK
#   st_buffer(dist = 0.00898) %>%  # 0.00898 decimal degrees = 1,000 m
#   st_union()
# saveRDS(wells_ak_buffer_1km,
#         "data/interim/buffers_wells/buffers_ak_buffer_1km.rds")
wells_az_buffer_1km <- wells_all %>%
filter(state == "AZ") %>%
st_transform(crs_albers) #%>%
plot(st_geometry(wells_az_buffer_1km))
LENGTHUNIT(crs_albers)
##### add more states, finalize
# processing and export ....................................................
# wells_ak_buffer_1km <- wells_all %>%
#   filter(state == "AK") %>%
#   st_transform(crs_albers) #%>%  ###### note: we need to find proj for AK
#   st_buffer(dist = 0.00898) %>%  # 0.00898 decimal degrees = 1,000 m
#   st_union()
# saveRDS(wells_ak_buffer_1km,
#         "data/interim/buffers_wells/buffers_ak_buffer_1km.rds")
wells_az_buffer_1km2 <- wells_all %>%
filter(state == "AZ") %>%
st_transform(crs_albers) #%>%
##### add more states, finalize
# processing and export ....................................................
# wells_ak_buffer_1km <- wells_all %>%
#   filter(state == "AK") %>%
#   st_transform(crs_albers) #%>%  ###### note: we need to find proj for AK
#   st_buffer(dist = 0.00898) %>%  # 0.00898 decimal degrees = 1,000 m
#   st_union()
# saveRDS(wells_ak_buffer_1km,
#         "data/interim/buffers_wells/buffers_ak_buffer_1km.rds")
wells_az_buffer_1km2 <- wells_all %>%
filter(state == "AZ") %>%
st_transform(crs_albers) %>%
st_buffer(dist = 1000) %>%
st_union()
plot(st_geometry(wells_az_buffer_1km2))
plot(st_geometry(wells_az_buffer_1km), add = T, col = "red")
rm(wells_az_buffer_1km2)
##### add more states, finalize
# processing and export ....................................................
# wells_ak_buffer_1km <- wells_all %>%
#   filter(state == "AK") %>%
#   st_transform(crs_albers) #%>%  ###### note: we need to find proj for AK
#   st_buffer(dist = 0.00898) %>%  # 0.00898 decimal degrees = 1,000 m
#   st_union()
# saveRDS(wells_ak_buffer_1km,
#         "data/interim/buffers_wells/buffers_ak_buffer_1km.rds")
wells_az_buffer_1km <- wells_all %>%
filter(state == "AZ") %>%
st_transform(crs_albers) %>%
st_buffer(dist = 1000) %>%
st_union()
saveRDS(wells_az_buffer_1km,
"data/interim/buffers_wells/buffers_az_buffer_1km.rds")
wells_ca_buffer_1km <- wells_all %>%
filter(state == "CA") %>%
st_buffer(dist = 0.00898) %>%
st_union()
##### add more states, finalize
# processing and export ....................................................
wells_ak_buffer_1km <- wells_all %>%
filter(state == "AK") %>%
st_transform(st_crs(3338)) %>%  # NAD83 / Alaska Albers
st_buffer(dist = 1000) %>%  # 0.00898 decimal degrees = 1,000 m
st_union()
st_crs(3338)
plot(st_geometry(wells_ak_buffer_1km))
